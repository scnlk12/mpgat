{'gpu': {'device_ids': [0], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'huber', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'progressive', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-04-22-50-33	Epoch 1	Train Loss = 0.15213, Val Loss = 0.04905
2026-01-04-22-52-38	Epoch 2	Train Loss = 0.02823, Val Loss = 0.04439
2026-01-04-22-54-43	Epoch 3	Train Loss = 0.02465, Val Loss = 0.04222
2026-01-04-22-56-48	Epoch 4	Train Loss = 0.02289, Val Loss = 0.04435
2026-01-04-22-58-53	Epoch 5	Train Loss = 0.02133, Val Loss = 0.03899
2026-01-04-23-00-58	Epoch 6	Train Loss = 0.02180, Val Loss = 0.04091
2026-01-04-23-03-04	Epoch 7	Train Loss = 0.02047, Val Loss = 0.03690
2026-01-04-23-05-09	Epoch 8	Train Loss = 0.01963, Val Loss = 0.03743
2026-01-04-23-07-14	Epoch 9	Train Loss = 0.01935, Val Loss = 0.03659
2026-01-04-23-09-19	Epoch 10	Train Loss = 0.01880, Val Loss = 0.03528
2026-01-04-23-11-24	Epoch 11	Train Loss = 0.01845, Val Loss = 0.03556
2026-01-04-23-13-29	Epoch 12	Train Loss = 0.01813, Val Loss = 0.03335
2026-01-04-23-15-34	Epoch 13	Train Loss = 0.01753, Val Loss = 0.03438
2026-01-04-23-17-40	Epoch 14	Train Loss = 0.01735, Val Loss = 0.03376
2026-01-04-23-19-45	Epoch 15	Train Loss = 0.01708, Val Loss = 0.03311
2026-01-04-23-21-50	Epoch 16	Train Loss = 0.01677, Val Loss = 0.03478
2026-01-04-23-23-55	Epoch 17	Train Loss = 0.01656, Val Loss = 0.03339
2026-01-04-23-26-00	Epoch 18	Train Loss = 0.01643, Val Loss = 0.03287
2026-01-04-23-28-05	Epoch 19	Train Loss = 0.01611, Val Loss = 0.03462
2026-01-04-23-30-10	Epoch 20	Train Loss = 0.01591, Val Loss = 0.03302
2026-01-04-23-32-15	Epoch 21	Train Loss = 0.01602, Val Loss = 0.03484
2026-01-04-23-34-20	Epoch 22	Train Loss = 0.01560, Val Loss = 0.03295
2026-01-04-23-36-25	Epoch 23	Train Loss = 0.01535, Val Loss = 0.03368
2026-01-04-23-38-30	Epoch 24	Train Loss = 0.01527, Val Loss = 0.03293
2026-01-04-23-40-35	Epoch 25	Train Loss = 0.01494, Val Loss = 0.03298
2026-01-04-23-42-40	Epoch 26	Train Loss = 0.01506, Val Loss = 0.03298
2026-01-04-23-44-46	Epoch 27	Train Loss = 0.01494, Val Loss = 0.03246
2026-01-04-23-46-51	Epoch 28	Train Loss = 0.01468, Val Loss = 0.03320
2026-01-04-23-48-56	Epoch 29	Train Loss = 0.01451, Val Loss = 0.03228
2026-01-04-23-51-01	Epoch 30	Train Loss = 0.01436, Val Loss = 0.03245
2026-01-04-23-53-06	Epoch 31	Train Loss = 0.01419, Val Loss = 0.03238
2026-01-04-23-55-11	Epoch 32	Train Loss = 0.01426, Val Loss = 0.03349
2026-01-04-23-57-16	Epoch 33	Train Loss = 0.01411, Val Loss = 0.03258
2026-01-04-23-59-21	Epoch 34	Train Loss = 0.01402, Val Loss = 0.03212
2026-01-05-00-01-27	Epoch 35	Train Loss = 0.01383, Val Loss = 0.03208
2026-01-05-00-03-32	Epoch 36	Train Loss = 0.01368, Val Loss = 0.03228
2026-01-05-00-05-37	Epoch 37	Train Loss = 0.01361, Val Loss = 0.03185
2026-01-05-00-07-42	Epoch 38	Train Loss = 0.01363, Val Loss = 0.03255
2026-01-05-00-09-47	Epoch 39	Train Loss = 0.01346, Val Loss = 0.03336
2026-01-05-00-11-53	Epoch 40	Train Loss = 0.01342, Val Loss = 0.03196
2026-01-05-00-13-58	Epoch 41	Train Loss = 0.01313, Val Loss = 0.03193
2026-01-05-00-16-02	Epoch 42	Train Loss = 0.01324, Val Loss = 0.03185
2026-01-05-00-18-07	Epoch 43	Train Loss = 0.01314, Val Loss = 0.03254
2026-01-05-00-20-12	Epoch 44	Train Loss = 0.01293, Val Loss = 0.03192
2026-01-05-00-22-17	Epoch 45	Train Loss = 0.01293, Val Loss = 0.03156
2026-01-05-00-24-22	Epoch 46	Train Loss = 0.01290, Val Loss = 0.03175
2026-01-05-00-26-27	Epoch 47	Train Loss = 0.01267, Val Loss = 0.03208
2026-01-05-00-28-32	Epoch 48	Train Loss = 0.01276, Val Loss = 0.03187
2026-01-05-00-30-37	Epoch 49	Train Loss = 0.01246, Val Loss = 0.03192
2026-01-05-00-32-43	Epoch 50	Train Loss = 0.01243, Val Loss = 0.03181
2026-01-05-00-34-48	Epoch 51	Train Loss = 0.01241, Val Loss = 0.03222
2026-01-05-00-36-53	Epoch 52	Train Loss = 0.01250, Val Loss = 0.03216
2026-01-05-00-38-58	Epoch 53	Train Loss = 0.01222, Val Loss = 0.03194
2026-01-05-00-41-03	Epoch 54	Train Loss = 0.01222, Val Loss = 0.03247
2026-01-05-00-43-08	Epoch 55	Train Loss = 0.01218, Val Loss = 0.03249
2026-01-05-00-45-13	Epoch 56	Train Loss = 0.01211, Val Loss = 0.03242
2026-01-05-00-47-18	Epoch 57	Train Loss = 0.01199, Val Loss = 0.03221
2026-01-05-00-49-23	Epoch 58	Train Loss = 0.01189, Val Loss = 0.03195
2026-01-05-00-51-28	Epoch 59	Train Loss = 0.01178, Val Loss = 0.03174
2026-01-05-00-53-33	Epoch 60	Train Loss = 0.01184, Val Loss = 0.03237
2026-01-05-00-55-38	Epoch 61	Train Loss = 0.01184, Val Loss = 0.03212
2026-01-05-00-57-43	Epoch 62	Train Loss = 0.01165, Val Loss = 0.03185
2026-01-05-00-59-48	Epoch 63	Train Loss = 0.01151, Val Loss = 0.03163
2026-01-05-01-01-53	Epoch 64	Train Loss = 0.01157, Val Loss = 0.03171
2026-01-05-01-03-58	Epoch 65	Train Loss = 0.01151, Val Loss = 0.03171
2026-01-05-01-06-03	Epoch 66	Train Loss = 0.01151, Val Loss = 0.03198
2026-01-05-01-08-08	Epoch 67	Train Loss = 0.01140, Val Loss = 0.03209
2026-01-05-01-10-13	Epoch 68	Train Loss = 0.01136, Val Loss = 0.03175
2026-01-05-01-12-18	Epoch 69	Train Loss = 0.01118, Val Loss = 0.03183
2026-01-05-01-14-23	Epoch 70	Train Loss = 0.01121, Val Loss = 0.03207
2026-01-05-01-16-28	Epoch 71	Train Loss = 0.01108, Val Loss = 0.03225
2026-01-05-01-18-33	Epoch 72	Train Loss = 0.01120, Val Loss = 0.03239
2026-01-05-01-20-38	Epoch 73	Train Loss = 0.01094, Val Loss = 0.03155
2026-01-05-01-22-43	Epoch 74	Train Loss = 0.01098, Val Loss = 0.03195
2026-01-05-01-24-48	Epoch 75	Train Loss = 0.01086, Val Loss = 0.03229
2026-01-05-01-26-53	Epoch 76	Train Loss = 0.01092, Val Loss = 0.03178
2026-01-05-01-28-58	Epoch 77	Train Loss = 0.01073, Val Loss = 0.03192
2026-01-05-01-31-03	Epoch 78	Train Loss = 0.01082, Val Loss = 0.03171
2026-01-05-01-33-08	Epoch 79	Train Loss = 0.01067, Val Loss = 0.03235
2026-01-05-01-35-13	Epoch 80	Train Loss = 0.01061, Val Loss = 0.03231
2026-01-05-01-37-18	Epoch 81	Train Loss = 0.01075, Val Loss = 0.03193
2026-01-05-01-39-23	Epoch 82	Train Loss = 0.01062, Val Loss = 0.03227
2026-01-05-01-41-28	Epoch 83	Train Loss = 0.01043, Val Loss = 0.03215
2026-01-05-01-43-33	Epoch 84	Train Loss = 0.01052, Val Loss = 0.03226
2026-01-05-01-45-38	Epoch 85	Train Loss = 0.01038, Val Loss = 0.03218
2026-01-05-01-47-43	Epoch 86	Train Loss = 0.01025, Val Loss = 0.03202
2026-01-05-01-49-48	Epoch 87	Train Loss = 0.01038, Val Loss = 0.03177
2026-01-05-01-51-53	Epoch 88	Train Loss = 0.01025, Val Loss = 0.03216
2026-01-05-01-53-58	Epoch 89	Train Loss = 0.01033, Val Loss = 0.03231
2026-01-05-01-56-03	Epoch 90	Train Loss = 0.01044, Val Loss = 0.03184
2026-01-05-01-58-08	Epoch 91	Train Loss = 0.01019, Val Loss = 0.03178
2026-01-05-02-00-13	Epoch 92	Train Loss = 0.01001, Val Loss = 0.03188
2026-01-05-02-02-18	Epoch 93	Train Loss = 0.01007, Val Loss = 0.03146
2026-01-05-02-04-23	Epoch 94	Train Loss = 0.00996, Val Loss = 0.03220
2026-01-05-02-06-28	Epoch 95	Train Loss = 0.00990, Val Loss = 0.03175
2026-01-05-02-08-32	Epoch 96	Train Loss = 0.00989, Val Loss = 0.03161
2026-01-05-02-10-37	Epoch 97	Train Loss = 0.00990, Val Loss = 0.03215
2026-01-05-02-12-42	Epoch 98	Train Loss = 0.00982, Val Loss = 0.03207
2026-01-05-02-14-47	Epoch 99	Train Loss = 0.00982, Val Loss = 0.03243
2026-01-05-02-16-52	Epoch 100	Train Loss = 0.00981, Val Loss = 0.03143
2026-01-05-02-18-57	Epoch 101	Train Loss = 0.00969, Val Loss = 0.03178
2026-01-05-02-21-02	Epoch 102	Train Loss = 0.00971, Val Loss = 0.03227
2026-01-05-02-23-07	Epoch 103	Train Loss = 0.00967, Val Loss = 0.03165
2026-01-05-02-25-12	Epoch 104	Train Loss = 0.00980, Val Loss = 0.03128
2026-01-05-02-27-17	Epoch 105	Train Loss = 0.00950, Val Loss = 0.03171
2026-01-05-02-29-22	Epoch 106	Train Loss = 0.00956, Val Loss = 0.03153
2026-01-05-02-31-27	Epoch 107	Train Loss = 0.00950, Val Loss = 0.03168
2026-01-05-02-33-31	Epoch 108	Train Loss = 0.00947, Val Loss = 0.03186
2026-01-05-02-35-36	Epoch 109	Train Loss = 0.00949, Val Loss = 0.03216
2026-01-05-02-37-41	Epoch 110	Train Loss = 0.00937, Val Loss = 0.03136
2026-01-05-02-39-46	Epoch 111	Train Loss = 0.00935, Val Loss = 0.03150
2026-01-05-02-41-51	Epoch 112	Train Loss = 0.00933, Val Loss = 0.03171
2026-01-05-02-43-56	Epoch 113	Train Loss = 0.00933, Val Loss = 0.03179
2026-01-05-02-46-01	Epoch 114	Train Loss = 0.00923, Val Loss = 0.03162
2026-01-05-02-48-06	Epoch 115	Train Loss = 0.00920, Val Loss = 0.03167
2026-01-05-02-50-11	Epoch 116	Train Loss = 0.00921, Val Loss = 0.03189
2026-01-05-02-52-16	Epoch 117	Train Loss = 0.00927, Val Loss = 0.03209
2026-01-05-02-54-20	Epoch 118	Train Loss = 0.00909, Val Loss = 0.03184
2026-01-05-02-56-25	Epoch 119	Train Loss = 0.00904, Val Loss = 0.03194
2026-01-05-02-58-30	Epoch 120	Train Loss = 0.00905, Val Loss = 0.03185
2026-01-05-03-00-35	Epoch 121	Train Loss = 0.00908, Val Loss = 0.03206
2026-01-05-03-02-40	Epoch 122	Train Loss = 0.00896, Val Loss = 0.03202
2026-01-05-03-04-45	Epoch 123	Train Loss = 0.00897, Val Loss = 0.03201
2026-01-05-03-06-50	Epoch 124	Train Loss = 0.00892, Val Loss = 0.03167
2026-01-05-03-08-55	Epoch 125	Train Loss = 0.00881, Val Loss = 0.03226
2026-01-05-03-11-00	Epoch 126	Train Loss = 0.00886, Val Loss = 0.03191
2026-01-05-03-13-05	Epoch 127	Train Loss = 0.00882, Val Loss = 0.03211
2026-01-05-03-15-10	Epoch 128	Train Loss = 0.00882, Val Loss = 0.03174
2026-01-05-03-17-15	Epoch 129	Train Loss = 0.00885, Val Loss = 0.03182
2026-01-05-03-19-20	Epoch 130	Train Loss = 0.00880, Val Loss = 0.03169
2026-01-05-03-21-25	Epoch 131	Train Loss = 0.00871, Val Loss = 0.03181
2026-01-05-03-23-30	Epoch 132	Train Loss = 0.00863, Val Loss = 0.03171
2026-01-05-03-25-35	Epoch 133	Train Loss = 0.00877, Val Loss = 0.03172
2026-01-05-03-27-40	Epoch 134	Train Loss = 0.00862, Val Loss = 0.03186
2026-01-05-03-29-44	Epoch 135	Train Loss = 0.00862, Val Loss = 0.03157
2026-01-05-03-31-49	Epoch 136	Train Loss = 0.00855, Val Loss = 0.03154
2026-01-05-03-33-54	Epoch 137	Train Loss = 0.00852, Val Loss = 0.03177
2026-01-05-03-35-59	Epoch 138	Train Loss = 0.00853, Val Loss = 0.03161
2026-01-05-03-38-04	Epoch 139	Train Loss = 0.00849, Val Loss = 0.03197
2026-01-05-03-40-09	Epoch 140	Train Loss = 0.00850, Val Loss = 0.03124
2026-01-05-03-42-14	Epoch 141	Train Loss = 0.00842, Val Loss = 0.03170
2026-01-05-03-44-19	Epoch 142	Train Loss = 0.00841, Val Loss = 0.03173
2026-01-05-03-46-24	Epoch 143	Train Loss = 0.00842, Val Loss = 0.03166
2026-01-05-03-48-29	Epoch 144	Train Loss = 0.00839, Val Loss = 0.03173
2026-01-05-03-50-34	Epoch 145	Train Loss = 0.00832, Val Loss = 0.03156
2026-01-05-03-52-39	Epoch 146	Train Loss = 0.00829, Val Loss = 0.03196
2026-01-05-03-54-44	Epoch 147	Train Loss = 0.00827, Val Loss = 0.03183
2026-01-05-03-56-49	Epoch 148	Train Loss = 0.00826, Val Loss = 0.03152
2026-01-05-03-58-53	Epoch 149	Train Loss = 0.00834, Val Loss = 0.03157
2026-01-05-04-00-58	Epoch 150	Train Loss = 0.00818, Val Loss = 0.03167
2026-01-05-04-03-03	Epoch 151	Train Loss = 0.00821, Val Loss = 0.03165
2026-01-05-04-05-08	Epoch 152	Train Loss = 0.00814, Val Loss = 0.03179
2026-01-05-04-07-13	Epoch 153	Train Loss = 0.00818, Val Loss = 0.03185
2026-01-05-04-09-18	Epoch 154	Train Loss = 0.00811, Val Loss = 0.03157
2026-01-05-04-11-23	Epoch 155	Train Loss = 0.00809, Val Loss = 0.03139
2026-01-05-04-13-28	Epoch 156	Train Loss = 0.00803, Val Loss = 0.03157
2026-01-05-04-15-33	Epoch 157	Train Loss = 0.00803, Val Loss = 0.03167
2026-01-05-04-17-37	Epoch 158	Train Loss = 0.00805, Val Loss = 0.03180
2026-01-05-04-19-42	Epoch 159	Train Loss = 0.00795, Val Loss = 0.03183
2026-01-05-04-21-47	Epoch 160	Train Loss = 0.00801, Val Loss = 0.03186
2026-01-05-04-23-52	Epoch 161	Train Loss = 0.00791, Val Loss = 0.03136
2026-01-05-04-25-57	Epoch 162	Train Loss = 0.00791, Val Loss = 0.03140
2026-01-05-04-28-02	Epoch 163	Train Loss = 0.00788, Val Loss = 0.03197
2026-01-05-04-30-07	Epoch 164	Train Loss = 0.00784, Val Loss = 0.03174
2026-01-05-04-32-12	Epoch 165	Train Loss = 0.00788, Val Loss = 0.03201
2026-01-05-04-34-17	Epoch 166	Train Loss = 0.00788, Val Loss = 0.03188
2026-01-05-04-36-21	Epoch 167	Train Loss = 0.00781, Val Loss = 0.03155
2026-01-05-04-38-26	Epoch 168	Train Loss = 0.00777, Val Loss = 0.03148
2026-01-05-04-40-31	Epoch 169	Train Loss = 0.00771, Val Loss = 0.03213
2026-01-05-04-42-36	Epoch 170	Train Loss = 0.00775, Val Loss = 0.03144
2026-01-05-04-44-41	Epoch 171	Train Loss = 0.00774, Val Loss = 0.03171
2026-01-05-04-46-46	Epoch 172	Train Loss = 0.00765, Val Loss = 0.03167
2026-01-05-04-48-51	Epoch 173	Train Loss = 0.00769, Val Loss = 0.03172
2026-01-05-04-50-56	Epoch 174	Train Loss = 0.00764, Val Loss = 0.03184
2026-01-05-04-53-00	Epoch 175	Train Loss = 0.00762, Val Loss = 0.03150
2026-01-05-04-55-05	Epoch 176	Train Loss = 0.00770, Val Loss = 0.03159
2026-01-05-04-57-10	Epoch 177	Train Loss = 0.00752, Val Loss = 0.03152
2026-01-05-04-59-15	Epoch 178	Train Loss = 0.00754, Val Loss = 0.03168
2026-01-05-05-01-20	Epoch 179	Train Loss = 0.00753, Val Loss = 0.03170
2026-01-05-05-03-25	Epoch 180	Train Loss = 0.00751, Val Loss = 0.03166
2026-01-05-05-05-30	Epoch 181	Train Loss = 0.00753, Val Loss = 0.03170
2026-01-05-05-07-35	Epoch 182	Train Loss = 0.00748, Val Loss = 0.03173
2026-01-05-05-09-40	Epoch 183	Train Loss = 0.00746, Val Loss = 0.03180
2026-01-05-05-11-45	Epoch 184	Train Loss = 0.00743, Val Loss = 0.03164
2026-01-05-05-13-50	Epoch 185	Train Loss = 0.00736, Val Loss = 0.03167
2026-01-05-05-15-55	Epoch 186	Train Loss = 0.00737, Val Loss = 0.03179
2026-01-05-05-17-59	Epoch 187	Train Loss = 0.00739, Val Loss = 0.03169
2026-01-05-05-20-04	Epoch 188	Train Loss = 0.00737, Val Loss = 0.03163
2026-01-05-05-22-09	Epoch 189	Train Loss = 0.00733, Val Loss = 0.03181
2026-01-05-05-24-14	Epoch 190	Train Loss = 0.00730, Val Loss = 0.03140
Early stopping at epoch: 190
Best at epoch 140:
Train Loss = 0.00850
Train RMSE = 271.37088, MAE = 230.41512, MAPE = 17078.01953
Val Loss = 0.03124
Val RMSE = 275.02094, MAE = 233.77907, MAPE = 12442.73047
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-04-22-48-27.pt
--------- Test ---------
All Steps RMSE = 25.82934, MAE = 15.89805, MAPE = 9.22823
Step  1 RMSE = 20.47849, MAE = 13.15812, MAPE = 7.62062
Step  2 RMSE = 22.53991, MAE = 14.28931, MAPE = 8.18303
Step  3 RMSE = 23.41325, MAE = 14.66290, MAPE = 8.34061
Step  4 RMSE = 24.54315, MAE = 15.28361, MAPE = 8.89350
Step  5 RMSE = 25.56338, MAE = 15.85338, MAPE = 9.30517
Step  6 RMSE = 25.91612, MAE = 15.97652, MAPE = 9.44424
Step  7 RMSE = 26.45430, MAE = 16.17647, MAPE = 9.19850
Step  8 RMSE = 27.31304, MAE = 16.78700, MAPE = 9.86209
Step  9 RMSE = 27.43035, MAE = 16.75002, MAPE = 9.63058
Step 10 RMSE = 27.77057, MAE = 16.90785, MAPE = 9.71919
Step 11 RMSE = 28.27520, MAE = 17.21716, MAPE = 9.91663
Step 12 RMSE = 28.87589, MAE = 17.71421, MAPE = 10.62493

Inference time: 12.68 s
