{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'progressive', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-08-14-05-39	Epoch 1	Train Loss = 0.16822, Val Loss = 0.14601
2026-01-08-14-07-43	Epoch 2	Train Loss = 0.13077, Val Loss = 0.14675
2026-01-08-14-09-47	Epoch 3	Train Loss = 0.12577, Val Loss = 0.14384
2026-01-08-14-11-52	Epoch 4	Train Loss = 0.12528, Val Loss = 0.14638
2026-01-08-14-13-56	Epoch 5	Train Loss = 0.12478, Val Loss = 0.14475
2026-01-08-14-16-00	Epoch 6	Train Loss = 0.12282, Val Loss = 0.13973
2026-01-08-14-18-05	Epoch 7	Train Loss = 0.11739, Val Loss = 0.13225
2026-01-08-14-20-09	Epoch 8	Train Loss = 0.11058, Val Loss = 0.13037
2026-01-08-14-22-13	Epoch 9	Train Loss = 0.10973, Val Loss = 0.12939
2026-01-08-14-24-18	Epoch 10	Train Loss = 0.10805, Val Loss = 0.12816
2026-01-08-14-26-22	Epoch 11	Train Loss = 0.10800, Val Loss = 0.13020
2026-01-08-14-28-26	Epoch 12	Train Loss = 0.10725, Val Loss = 0.12926
2026-01-08-14-30-31	Epoch 13	Train Loss = 0.10782, Val Loss = 0.12792
2026-01-08-14-32-35	Epoch 14	Train Loss = 0.10977, Val Loss = 0.13372
2026-01-08-14-34-39	Epoch 15	Train Loss = 0.11116, Val Loss = 0.13356
2026-01-08-14-36-43	Epoch 16	Train Loss = 0.11635, Val Loss = 0.13369
2026-01-08-14-38-48	Epoch 17	Train Loss = 0.11266, Val Loss = 0.13141
2026-01-08-14-40-52	Epoch 18	Train Loss = 0.11362, Val Loss = 0.13434
2026-01-08-14-42-56	Epoch 19	Train Loss = 0.11109, Val Loss = 0.12953
2026-01-08-14-45-00	Epoch 20	Train Loss = 0.11047, Val Loss = 0.13173
2026-01-08-14-47-04	Epoch 21	Train Loss = 0.15450, Val Loss = 0.15444
2026-01-08-14-49-09	Epoch 22	Train Loss = 0.13462, Val Loss = 0.15137
2026-01-08-14-51-13	Epoch 23	Train Loss = 0.12755, Val Loss = 0.14432
2026-01-08-14-53-17	Epoch 24	Train Loss = 0.12402, Val Loss = 0.14264
2026-01-08-14-55-21	Epoch 25	Train Loss = 0.11937, Val Loss = 0.13981
2026-01-08-14-57-25	Epoch 26	Train Loss = 0.11891, Val Loss = 0.13873
2026-01-08-14-59-29	Epoch 27	Train Loss = 0.11722, Val Loss = 0.13659
2026-01-08-15-01-34	Epoch 28	Train Loss = 0.11712, Val Loss = 0.14533
2026-01-08-15-03-38	Epoch 29	Train Loss = 0.12142, Val Loss = 0.14241
2026-01-08-15-05-42	Epoch 30	Train Loss = 0.12281, Val Loss = 0.14535
2026-01-08-15-07-46	Epoch 31	Train Loss = 0.12354, Val Loss = 0.14594
2026-01-08-15-09-50	Epoch 32	Train Loss = 0.12258, Val Loss = 0.14423
2026-01-08-15-11-54	Epoch 33	Train Loss = 0.11933, Val Loss = 0.13834
2026-01-08-15-13-58	Epoch 34	Train Loss = 0.11606, Val Loss = 0.13824
2026-01-08-15-16-02	Epoch 35	Train Loss = 0.11560, Val Loss = 0.13531
2026-01-08-15-18-06	Epoch 36	Train Loss = 0.11490, Val Loss = 0.13549
2026-01-08-15-20-11	Epoch 37	Train Loss = 0.11480, Val Loss = 0.13815
2026-01-08-15-22-15	Epoch 38	Train Loss = 0.11649, Val Loss = 0.13580
2026-01-08-15-24-19	Epoch 39	Train Loss = 0.11299, Val Loss = 0.13282
2026-01-08-15-26-23	Epoch 40	Train Loss = 0.11279, Val Loss = 0.13443
2026-01-08-15-28-27	Epoch 41	Train Loss = 0.11163, Val Loss = 0.13465
2026-01-08-15-30-31	Epoch 42	Train Loss = 0.11178, Val Loss = 0.13290
2026-01-08-15-32-35	Epoch 43	Train Loss = 0.11185, Val Loss = 0.13366
2026-01-08-15-34-39	Epoch 44	Train Loss = 0.11113, Val Loss = 0.13594
2026-01-08-15-36-43	Epoch 45	Train Loss = 0.11406, Val Loss = 0.13105
2026-01-08-15-38-47	Epoch 46	Train Loss = 0.11171, Val Loss = 0.13378
2026-01-08-15-40-51	Epoch 47	Train Loss = 0.11022, Val Loss = 0.13036
2026-01-08-15-42-55	Epoch 48	Train Loss = 0.10990, Val Loss = 0.13096
2026-01-08-15-44-59	Epoch 49	Train Loss = 0.10999, Val Loss = 0.13070
2026-01-08-15-47-04	Epoch 50	Train Loss = 0.10938, Val Loss = 0.12967
2026-01-08-15-49-08	Epoch 51	Train Loss = 0.10846, Val Loss = 0.13448
2026-01-08-15-51-12	Epoch 52	Train Loss = 0.10861, Val Loss = 0.13128
2026-01-08-15-53-16	Epoch 53	Train Loss = 0.10902, Val Loss = 0.13317
2026-01-08-15-55-20	Epoch 54	Train Loss = 0.10844, Val Loss = 0.13048
2026-01-08-15-57-24	Epoch 55	Train Loss = 0.10937, Val Loss = 0.12905
2026-01-08-15-59-28	Epoch 56	Train Loss = 0.10801, Val Loss = 0.12877
2026-01-08-16-01-32	Epoch 57	Train Loss = 0.10859, Val Loss = 0.12834
2026-01-08-16-03-36	Epoch 58	Train Loss = 0.10799, Val Loss = 0.12859
2026-01-08-16-05-40	Epoch 59	Train Loss = 0.10740, Val Loss = 0.13217
2026-01-08-16-07-44	Epoch 60	Train Loss = 0.10859, Val Loss = 0.13175
2026-01-08-16-09-49	Epoch 61	Train Loss = 0.17316, Val Loss = 0.14685
2026-01-08-16-11-53	Epoch 62	Train Loss = 0.12271, Val Loss = 0.14355
2026-01-08-16-13-57	Epoch 63	Train Loss = 0.12100, Val Loss = 0.14120
2026-01-08-16-16-01	Epoch 64	Train Loss = 0.12000, Val Loss = 0.14133
2026-01-08-16-18-05	Epoch 65	Train Loss = 0.11912, Val Loss = 0.14129
2026-01-08-16-20-09	Epoch 66	Train Loss = 0.11895, Val Loss = 0.13805
2026-01-08-16-22-13	Epoch 67	Train Loss = 0.11569, Val Loss = 0.13699
2026-01-08-16-24-17	Epoch 68	Train Loss = 0.11590, Val Loss = 0.13642
2026-01-08-16-26-21	Epoch 69	Train Loss = 0.11485, Val Loss = 0.13724
2026-01-08-16-28-25	Epoch 70	Train Loss = 0.11671, Val Loss = 0.13713
2026-01-08-16-30-29	Epoch 71	Train Loss = 0.11501, Val Loss = 0.13769
2026-01-08-16-32-33	Epoch 72	Train Loss = 0.11418, Val Loss = 0.13413
2026-01-08-16-34-37	Epoch 73	Train Loss = 0.11434, Val Loss = 0.13772
2026-01-08-16-36-41	Epoch 74	Train Loss = 0.11501, Val Loss = 0.13503
2026-01-08-16-38-45	Epoch 75	Train Loss = 0.11431, Val Loss = 0.13610
2026-01-08-16-40-49	Epoch 76	Train Loss = 0.11340, Val Loss = 0.13569
2026-01-08-16-42-53	Epoch 77	Train Loss = 0.11199, Val Loss = 0.13333
2026-01-08-16-44-57	Epoch 78	Train Loss = 0.11073, Val Loss = 0.13349
2026-01-08-16-47-01	Epoch 79	Train Loss = 0.11029, Val Loss = 0.13342
2026-01-08-16-49-05	Epoch 80	Train Loss = 0.11023, Val Loss = 0.13176
2026-01-08-16-51-09	Epoch 81	Train Loss = 0.11042, Val Loss = 0.13081
2026-01-08-16-53-13	Epoch 82	Train Loss = 0.11004, Val Loss = 0.13230
2026-01-08-16-55-17	Epoch 83	Train Loss = 0.10852, Val Loss = 0.13056
2026-01-08-16-57-21	Epoch 84	Train Loss = 0.10935, Val Loss = 0.13030
2026-01-08-16-59-25	Epoch 85	Train Loss = 0.11020, Val Loss = 0.13621
2026-01-08-17-01-29	Epoch 86	Train Loss = 0.10992, Val Loss = 0.13105
2026-01-08-17-03-33	Epoch 87	Train Loss = 0.10901, Val Loss = 0.13064
2026-01-08-17-05-37	Epoch 88	Train Loss = 0.10820, Val Loss = 0.13033
2026-01-08-17-07-41	Epoch 89	Train Loss = 0.10783, Val Loss = 0.13165
2026-01-08-17-09-45	Epoch 90	Train Loss = 0.10758, Val Loss = 0.12974
2026-01-08-17-11-49	Epoch 91	Train Loss = 0.10750, Val Loss = 0.13731
2026-01-08-17-13-53	Epoch 92	Train Loss = 0.10686, Val Loss = 0.13112
2026-01-08-17-15-57	Epoch 93	Train Loss = 0.10732, Val Loss = 0.12941
2026-01-08-17-18-01	Epoch 94	Train Loss = 0.10763, Val Loss = 0.13041
2026-01-08-17-20-05	Epoch 95	Train Loss = 0.10725, Val Loss = 0.12829
2026-01-08-17-22-09	Epoch 96	Train Loss = 0.10615, Val Loss = 0.13338
2026-01-08-17-24-13	Epoch 97	Train Loss = 0.10706, Val Loss = 0.12942
2026-01-08-17-26-17	Epoch 98	Train Loss = 0.10781, Val Loss = 0.13197
2026-01-08-17-28-21	Epoch 99	Train Loss = 0.10785, Val Loss = 0.13160
2026-01-08-17-30-25	Epoch 100	Train Loss = 0.10771, Val Loss = 0.12781
2026-01-08-17-32-29	Epoch 101	Train Loss = 0.10549, Val Loss = 0.12864
2026-01-08-17-34-33	Epoch 102	Train Loss = 0.10635, Val Loss = 0.12994
2026-01-08-17-36-37	Epoch 103	Train Loss = 0.10561, Val Loss = 0.12851
2026-01-08-17-38-40	Epoch 104	Train Loss = 0.10574, Val Loss = 0.13460
2026-01-08-17-40-44	Epoch 105	Train Loss = 0.10594, Val Loss = 0.13099
2026-01-08-17-42-48	Epoch 106	Train Loss = 0.10518, Val Loss = 0.12883
2026-01-08-17-44-52	Epoch 107	Train Loss = 0.10514, Val Loss = 0.12702
2026-01-08-17-46-56	Epoch 108	Train Loss = 0.10518, Val Loss = 0.12980
2026-01-08-17-49-00	Epoch 109	Train Loss = 0.10596, Val Loss = 0.13313
2026-01-08-17-51-04	Epoch 110	Train Loss = 0.10467, Val Loss = 0.12946
2026-01-08-17-53-08	Epoch 111	Train Loss = 0.10529, Val Loss = 0.13004
2026-01-08-17-55-12	Epoch 112	Train Loss = 0.10515, Val Loss = 0.12805
2026-01-08-17-57-16	Epoch 113	Train Loss = 0.10332, Val Loss = 0.12723
2026-01-08-17-59-20	Epoch 114	Train Loss = 0.10612, Val Loss = 0.12838
2026-01-08-18-01-24	Epoch 115	Train Loss = 0.10421, Val Loss = 0.12925
2026-01-08-18-03-28	Epoch 116	Train Loss = 0.10389, Val Loss = 0.12892
2026-01-08-18-05-32	Epoch 117	Train Loss = 0.10416, Val Loss = 0.12842
2026-01-08-18-07-36	Epoch 118	Train Loss = 0.10393, Val Loss = 0.12719
2026-01-08-18-09-40	Epoch 119	Train Loss = 0.10346, Val Loss = 0.12894
2026-01-08-18-11-44	Epoch 120	Train Loss = 0.10329, Val Loss = 0.12915
2026-01-08-18-13-48	Epoch 121	Train Loss = 0.10593, Val Loss = 0.13050
2026-01-08-18-15-52	Epoch 122	Train Loss = 0.10602, Val Loss = 0.13133
2026-01-08-18-17-56	Epoch 123	Train Loss = 0.10809, Val Loss = 0.14358
2026-01-08-18-20-00	Epoch 124	Train Loss = 0.11110, Val Loss = 0.13671
2026-01-08-18-22-03	Epoch 125	Train Loss = 0.10721, Val Loss = 0.13294
2026-01-08-18-24-07	Epoch 126	Train Loss = 0.10816, Val Loss = 0.13489
2026-01-08-18-26-11	Epoch 127	Train Loss = 0.10539, Val Loss = 0.13150
2026-01-08-18-28-15	Epoch 128	Train Loss = 0.10533, Val Loss = 0.13087
2026-01-08-18-30-19	Epoch 129	Train Loss = 0.10367, Val Loss = 0.12955
2026-01-08-18-32-23	Epoch 130	Train Loss = 0.10350, Val Loss = 0.13030
2026-01-08-18-34-27	Epoch 131	Train Loss = 0.10278, Val Loss = 0.12741
2026-01-08-18-36-31	Epoch 132	Train Loss = 0.10400, Val Loss = 0.12806
2026-01-08-18-38-35	Epoch 133	Train Loss = 0.10807, Val Loss = 0.13104
2026-01-08-18-40-39	Epoch 134	Train Loss = 0.10872, Val Loss = 0.12890
2026-01-08-18-42-43	Epoch 135	Train Loss = 0.11364, Val Loss = 0.13139
2026-01-08-18-44-46	Epoch 136	Train Loss = 0.10843, Val Loss = 0.13708
2026-01-08-18-46-50	Epoch 137	Train Loss = 0.10712, Val Loss = 0.13536
2026-01-08-18-48-54	Epoch 138	Train Loss = 0.10496, Val Loss = 0.12887
2026-01-08-18-50-58	Epoch 139	Train Loss = 0.10341, Val Loss = 0.12956
2026-01-08-18-53-02	Epoch 140	Train Loss = 0.10429, Val Loss = 0.13059
2026-01-08-18-55-06	Epoch 141	Train Loss = 0.10401, Val Loss = 0.12973
2026-01-08-18-57-10	Epoch 142	Train Loss = 0.10653, Val Loss = 0.12911
2026-01-08-18-59-14	Epoch 143	Train Loss = 0.10333, Val Loss = 0.12859
2026-01-08-19-01-18	Epoch 144	Train Loss = 0.10287, Val Loss = 0.13038
2026-01-08-19-03-22	Epoch 145	Train Loss = 0.10297, Val Loss = 0.12706
2026-01-08-19-05-25	Epoch 146	Train Loss = 0.10369, Val Loss = 0.12800
2026-01-08-19-07-29	Epoch 147	Train Loss = 0.10228, Val Loss = 0.12761
2026-01-08-19-09-33	Epoch 148	Train Loss = 0.10524, Val Loss = 0.13110
2026-01-08-19-11-37	Epoch 149	Train Loss = 0.10264, Val Loss = 0.12991
2026-01-08-19-13-41	Epoch 150	Train Loss = 0.10306, Val Loss = 0.12961
2026-01-08-19-15-45	Epoch 151	Train Loss = 0.10278, Val Loss = 0.12816
2026-01-08-19-17-49	Epoch 152	Train Loss = 0.10616, Val Loss = 0.13440
2026-01-08-19-19-53	Epoch 153	Train Loss = 0.10439, Val Loss = 0.12785
2026-01-08-19-21-56	Epoch 154	Train Loss = 0.10447, Val Loss = 0.13457
2026-01-08-19-24-00	Epoch 155	Train Loss = 0.10304, Val Loss = 0.13043
2026-01-08-19-26-04	Epoch 156	Train Loss = 0.10286, Val Loss = 0.13223
2026-01-08-19-28-08	Epoch 157	Train Loss = 0.10416, Val Loss = 0.12762
Early stopping at epoch: 157
Best at epoch 107:
Train Loss = 0.10514
Train RMSE = 270.19415, MAE = 228.80806, MAPE = 13619.81836
Val Loss = 0.12702
Val RMSE = 274.09073, MAE = 231.92007, MAPE = 11623.08594
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-08-14-03-34.pt
--------- Test ---------
All Steps RMSE = 24.05294, MAE = 15.17742, MAPE = 8.83768
Step  1 RMSE = 20.24223, MAE = 13.01715, MAPE = 7.59244
Step  2 RMSE = 21.66977, MAE = 13.89764, MAPE = 8.20049
Step  3 RMSE = 22.51112, MAE = 14.35016, MAPE = 8.27067
Step  4 RMSE = 23.07869, MAE = 14.58300, MAPE = 8.44399
Step  5 RMSE = 23.75957, MAE = 15.03219, MAPE = 8.73763
Step  6 RMSE = 24.06220, MAE = 15.11670, MAPE = 8.80182
Step  7 RMSE = 24.54225, MAE = 15.43457, MAPE = 8.96659
Step  8 RMSE = 25.00004, MAE = 15.74218, MAPE = 9.12862
Step  9 RMSE = 25.38818, MAE = 16.04467, MAPE = 9.37949
Step 10 RMSE = 25.53584, MAE = 16.06187, MAPE = 9.37096
Step 11 RMSE = 25.94254, MAE = 16.32520, MAPE = 9.49926
Step 12 RMSE = 26.14070, MAE = 16.52374, MAPE = 9.66040

Inference time: 12.66 s
