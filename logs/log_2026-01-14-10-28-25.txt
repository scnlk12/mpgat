{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'exponential', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-14-10-30-38	Epoch 1	Train Loss = 0.84241, Val Loss = 0.14711
2026-01-14-10-32-45	Epoch 2	Train Loss = 0.60724, Val Loss = 0.14877
2026-01-14-10-34-53	Epoch 3	Train Loss = 0.59986, Val Loss = 0.15204
2026-01-14-10-37-01	Epoch 4	Train Loss = 0.59468, Val Loss = 0.14807
2026-01-14-10-39-08	Epoch 5	Train Loss = 0.59035, Val Loss = 0.14918
2026-01-14-10-41-16	Epoch 6	Train Loss = 0.59184, Val Loss = 0.14722
2026-01-14-10-43-23	Epoch 7	Train Loss = 0.58815, Val Loss = 0.15442
2026-01-14-10-45-31	Epoch 8	Train Loss = 0.58847, Val Loss = 0.14452
2026-01-14-10-47-38	Epoch 9	Train Loss = 0.58803, Val Loss = 0.14773
2026-01-14-10-49-46	Epoch 10	Train Loss = 0.58776, Val Loss = 0.14735
2026-01-14-10-51-53	Epoch 11	Train Loss = 0.58665, Val Loss = 0.14392
2026-01-14-10-54-01	Epoch 12	Train Loss = 0.58335, Val Loss = 0.14427
2026-01-14-10-56-09	Epoch 13	Train Loss = 0.58198, Val Loss = 0.14695
2026-01-14-10-58-16	Epoch 14	Train Loss = 0.58404, Val Loss = 0.14353
2026-01-14-11-00-24	Epoch 15	Train Loss = 0.58169, Val Loss = 0.14173
2026-01-14-11-02-31	Epoch 16	Train Loss = 0.58388, Val Loss = 0.14353
2026-01-14-11-04-39	Epoch 17	Train Loss = 0.58072, Val Loss = 0.14535
2026-01-14-11-06-46	Epoch 18	Train Loss = 0.56713, Val Loss = 0.13512
2026-01-14-11-08-54	Epoch 19	Train Loss = 0.54475, Val Loss = 0.12791
2026-01-14-11-11-01	Epoch 20	Train Loss = 0.53018, Val Loss = 0.12588
2026-01-14-11-13-08	Epoch 21	Train Loss = 0.52832, Val Loss = 0.12490
2026-01-14-11-15-16	Epoch 22	Train Loss = 0.52181, Val Loss = 0.12381
2026-01-14-11-17-23	Epoch 23	Train Loss = 0.52043, Val Loss = 0.12282
2026-01-14-11-19-31	Epoch 24	Train Loss = 0.51618, Val Loss = 0.12362
2026-01-14-11-21-38	Epoch 25	Train Loss = 0.51362, Val Loss = 0.12213
2026-01-14-11-23-45	Epoch 26	Train Loss = 0.51184, Val Loss = 0.12130
2026-01-14-11-25-53	Epoch 27	Train Loss = 0.51081, Val Loss = 0.12201
2026-01-14-11-28-00	Epoch 28	Train Loss = 0.50854, Val Loss = 0.12212
2026-01-14-11-30-07	Epoch 29	Train Loss = 0.50789, Val Loss = 0.12139
2026-01-14-11-32-15	Epoch 30	Train Loss = 0.50650, Val Loss = 0.11941
2026-01-14-11-34-22	Epoch 31	Train Loss = 0.50856, Val Loss = 0.12010
2026-01-14-11-36-30	Epoch 32	Train Loss = 0.50483, Val Loss = 0.12020
2026-01-14-11-38-37	Epoch 33	Train Loss = 0.50577, Val Loss = 0.11925
2026-01-14-11-40-45	Epoch 34	Train Loss = 0.50267, Val Loss = 0.11984
2026-01-14-11-42-52	Epoch 35	Train Loss = 0.50227, Val Loss = 0.12075
2026-01-14-11-44-59	Epoch 36	Train Loss = 0.50303, Val Loss = 0.12003
2026-01-14-11-47-07	Epoch 37	Train Loss = 0.50230, Val Loss = 0.12200
2026-01-14-11-49-14	Epoch 38	Train Loss = 0.50248, Val Loss = 0.11926
2026-01-14-11-51-21	Epoch 39	Train Loss = 0.50096, Val Loss = 0.11814
2026-01-14-11-53-29	Epoch 40	Train Loss = 0.50026, Val Loss = 0.11860
2026-01-14-11-55-36	Epoch 41	Train Loss = 0.58230, Val Loss = 0.14337
2026-01-14-11-57-44	Epoch 42	Train Loss = 0.53035, Val Loss = 0.13759
2026-01-14-11-59-51	Epoch 43	Train Loss = 0.52338, Val Loss = 0.13217
2026-01-14-12-01-59	Epoch 44	Train Loss = 0.51413, Val Loss = 0.12810
2026-01-14-12-04-06	Epoch 45	Train Loss = 0.51506, Val Loss = 0.12895
2026-01-14-12-06-13	Epoch 46	Train Loss = 0.51192, Val Loss = 0.12711
2026-01-14-12-08-21	Epoch 47	Train Loss = 0.50960, Val Loss = 0.12845
2026-01-14-12-10-28	Epoch 48	Train Loss = 0.51111, Val Loss = 0.12739
2026-01-14-12-12-35	Epoch 49	Train Loss = 0.51034, Val Loss = 0.12631
2026-01-14-12-14-43	Epoch 50	Train Loss = 0.50777, Val Loss = 0.12557
2026-01-14-12-16-50	Epoch 51	Train Loss = 0.50640, Val Loss = 0.12712
2026-01-14-12-18-57	Epoch 52	Train Loss = 0.50783, Val Loss = 0.12635
2026-01-14-12-21-04	Epoch 53	Train Loss = 0.50924, Val Loss = 0.12754
2026-01-14-12-23-12	Epoch 54	Train Loss = 0.50902, Val Loss = 0.12682
2026-01-14-12-25-19	Epoch 55	Train Loss = 0.50982, Val Loss = 0.12833
2026-01-14-12-27-26	Epoch 56	Train Loss = 0.50895, Val Loss = 0.12556
2026-01-14-12-29-33	Epoch 57	Train Loss = 0.51025, Val Loss = 0.13095
2026-01-14-12-31-41	Epoch 58	Train Loss = 0.51042, Val Loss = 0.12563
2026-01-14-12-33-48	Epoch 59	Train Loss = 0.50874, Val Loss = 0.12629
2026-01-14-12-35-55	Epoch 60	Train Loss = 0.51146, Val Loss = 0.12596
2026-01-14-12-38-02	Epoch 61	Train Loss = 0.50985, Val Loss = 0.13157
2026-01-14-12-40-10	Epoch 62	Train Loss = 0.51185, Val Loss = 0.13039
2026-01-14-12-42-17	Epoch 63	Train Loss = 0.51820, Val Loss = 0.12758
2026-01-14-12-44-24	Epoch 64	Train Loss = 0.51730, Val Loss = 0.13678
2026-01-14-12-46-31	Epoch 65	Train Loss = 0.51594, Val Loss = 0.12958
2026-01-14-12-48-38	Epoch 66	Train Loss = 0.51529, Val Loss = 0.12968
2026-01-14-12-50-46	Epoch 67	Train Loss = 0.51944, Val Loss = 0.13209
2026-01-14-12-52-53	Epoch 68	Train Loss = 0.52379, Val Loss = 0.13274
2026-01-14-12-55-00	Epoch 69	Train Loss = 0.52104, Val Loss = 0.12996
2026-01-14-12-57-07	Epoch 70	Train Loss = 0.51536, Val Loss = 0.12979
2026-01-14-12-59-15	Epoch 71	Train Loss = 0.57323, Val Loss = 0.16854
2026-01-14-13-01-22	Epoch 72	Train Loss = 0.54939, Val Loss = 0.15434
2026-01-14-13-03-29	Epoch 73	Train Loss = 0.54443, Val Loss = 0.14869
2026-01-14-13-05-36	Epoch 74	Train Loss = 0.54350, Val Loss = 0.15307
2026-01-14-13-07-44	Epoch 75	Train Loss = 0.54118, Val Loss = 0.14825
2026-01-14-13-09-51	Epoch 76	Train Loss = 0.53533, Val Loss = 0.14696
2026-01-14-13-11-58	Epoch 77	Train Loss = 0.53494, Val Loss = 0.14602
2026-01-14-13-14-05	Epoch 78	Train Loss = 0.53387, Val Loss = 0.15345
2026-01-14-13-16-12	Epoch 79	Train Loss = 0.54021, Val Loss = 0.14604
2026-01-14-13-18-20	Epoch 80	Train Loss = 0.53695, Val Loss = 0.14571
2026-01-14-13-20-27	Epoch 81	Train Loss = 0.53915, Val Loss = 0.14806
2026-01-14-13-22-34	Epoch 82	Train Loss = 0.53785, Val Loss = 0.14598
2026-01-14-13-24-41	Epoch 83	Train Loss = 0.53801, Val Loss = 0.14814
2026-01-14-13-26-48	Epoch 84	Train Loss = 0.54370, Val Loss = 0.14948
2026-01-14-13-28-55	Epoch 85	Train Loss = 0.54501, Val Loss = 0.15001
2026-01-14-13-31-02	Epoch 86	Train Loss = 0.54089, Val Loss = 0.14898
2026-01-14-13-33-10	Epoch 87	Train Loss = 0.54548, Val Loss = 0.15188
2026-01-14-13-35-17	Epoch 88	Train Loss = 0.54382, Val Loss = 0.15350
2026-01-14-13-37-24	Epoch 89	Train Loss = 0.54650, Val Loss = 0.15174
2026-01-14-13-39-31	Epoch 90	Train Loss = 0.54275, Val Loss = 0.15183
2026-01-14-13-41-38	Epoch 91	Train Loss = 0.54572, Val Loss = 0.15492
2026-01-14-13-43-45	Epoch 92	Train Loss = 0.55082, Val Loss = 0.15383
2026-01-14-13-45-52	Epoch 93	Train Loss = 0.54570, Val Loss = 0.15073
2026-01-14-13-47-59	Epoch 94	Train Loss = 0.54615, Val Loss = 0.15401
2026-01-14-13-50-06	Epoch 95	Train Loss = 0.54245, Val Loss = 0.15089
2026-01-14-13-52-14	Epoch 96	Train Loss = 0.54025, Val Loss = 0.15244
2026-01-14-13-54-21	Epoch 97	Train Loss = 0.54058, Val Loss = 0.15112
2026-01-14-13-56-28	Epoch 98	Train Loss = 0.54266, Val Loss = 0.15250
2026-01-14-13-58-35	Epoch 99	Train Loss = 0.54293, Val Loss = 0.14919
2026-01-14-14-00-42	Epoch 100	Train Loss = 0.54088, Val Loss = 0.14753
2026-01-14-14-02-49	Epoch 101	Train Loss = 0.54215, Val Loss = 0.15002
2026-01-14-14-04-56	Epoch 102	Train Loss = 0.54269, Val Loss = 0.15206
2026-01-14-14-07-03	Epoch 103	Train Loss = 0.54391, Val Loss = 0.14832
2026-01-14-14-09-10	Epoch 104	Train Loss = 0.54203, Val Loss = 0.15032
2026-01-14-14-11-17	Epoch 105	Train Loss = 0.54811, Val Loss = 0.15064
2026-01-14-14-13-24	Epoch 106	Train Loss = 0.54119, Val Loss = 0.15484
2026-01-14-14-15-32	Epoch 107	Train Loss = 0.54182, Val Loss = 0.14805
2026-01-14-14-17-39	Epoch 108	Train Loss = 0.54472, Val Loss = 0.15005
2026-01-14-14-19-46	Epoch 109	Train Loss = 0.54495, Val Loss = 0.15103
2026-01-14-14-21-53	Epoch 110	Train Loss = 0.54645, Val Loss = 0.15171
2026-01-14-14-24-00	Epoch 111	Train Loss = 0.54406, Val Loss = 0.15197
2026-01-14-14-26-07	Epoch 112	Train Loss = 0.54702, Val Loss = 0.15074
2026-01-14-14-28-14	Epoch 113	Train Loss = 0.54419, Val Loss = 0.15085
2026-01-14-14-30-21	Epoch 114	Train Loss = 0.54351, Val Loss = 0.14851
2026-01-14-14-32-28	Epoch 115	Train Loss = 0.54495, Val Loss = 0.14658
2026-01-14-14-34-35	Epoch 116	Train Loss = 0.54067, Val Loss = 0.14809
2026-01-14-14-36-42	Epoch 117	Train Loss = 0.54223, Val Loss = 0.14903
2026-01-14-14-38-49	Epoch 118	Train Loss = 0.54232, Val Loss = 0.15062
2026-01-14-14-40-56	Epoch 119	Train Loss = 0.54515, Val Loss = 0.15171
2026-01-14-14-43-03	Epoch 120	Train Loss = 0.54856, Val Loss = 0.15270
2026-01-14-14-45-10	Epoch 121	Train Loss = 0.54497, Val Loss = 0.14926
2026-01-14-14-47-17	Epoch 122	Train Loss = 0.53952, Val Loss = 0.14733
2026-01-14-14-49-24	Epoch 123	Train Loss = 0.53878, Val Loss = 0.14634
2026-01-14-14-51-31	Epoch 124	Train Loss = 0.53574, Val Loss = 0.14671
2026-01-14-14-53-38	Epoch 125	Train Loss = 0.53675, Val Loss = 0.14842
2026-01-14-14-55-45	Epoch 126	Train Loss = 0.54338, Val Loss = 0.14982
2026-01-14-14-57-53	Epoch 127	Train Loss = 0.54011, Val Loss = 0.14583
2026-01-14-15-00-00	Epoch 128	Train Loss = 0.54275, Val Loss = 0.14829
2026-01-14-15-02-07	Epoch 129	Train Loss = 0.54445, Val Loss = 0.14888
2026-01-14-15-04-14	Epoch 130	Train Loss = 0.54408, Val Loss = 0.15045
Early stopping at epoch: 130
Best at epoch 80:
Train Loss = 0.53695
Train RMSE = 272.22214, MAE = 230.71605, MAPE = 14354.64160
Val Loss = 0.14571
Val RMSE = 275.90555, MAE = 233.35687, MAPE = 11912.42188
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-14-10-28-29.pt
--------- Test ---------
All Steps RMSE = 27.73707, MAE = 17.46538, MAPE = 10.20042
Step  1 RMSE = 20.32561, MAE = 13.02175, MAPE = 7.57300
Step  2 RMSE = 22.66067, MAE = 14.46479, MAPE = 8.34828
Step  3 RMSE = 24.18617, MAE = 15.43215, MAPE = 8.86677
Step  4 RMSE = 25.39489, MAE = 16.11584, MAPE = 9.27246
Step  5 RMSE = 26.36146, MAE = 16.66741, MAPE = 9.62280
Step  6 RMSE = 27.31821, MAE = 17.27277, MAPE = 10.04913
Step  7 RMSE = 28.39803, MAE = 17.98063, MAPE = 10.51661
Step  8 RMSE = 29.50070, MAE = 18.65807, MAPE = 10.90731
Step  9 RMSE = 30.35624, MAE = 19.22200, MAPE = 11.30164
Step 10 RMSE = 31.00210, MAE = 19.67147, MAPE = 11.72668
Step 11 RMSE = 31.71802, MAE = 20.21149, MAPE = 11.99965
Step 12 RMSE = 32.69585, MAE = 20.86613, MAPE = 12.22126

Inference time: 12.93 s
