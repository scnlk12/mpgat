{'gpu': {'device_ids': [0], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 1, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.001, 'clip_grad': 5, 'loss_func': 'mse', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'progressive', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0002, 'dropout': 0.1, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2025-12-29-16-11-48	Epoch 1	Train Loss = 32585.66453, Val Loss = 14111.90029
2025-12-29-16-12-34	Epoch 2	Train Loss = 12383.59249, Val Loss = 13277.86220
2025-12-29-16-13-20	Epoch 3	Train Loss = 7503.44589, Val Loss = 5541.01802
2025-12-29-16-14-05	Epoch 4	Train Loss = 4838.49647, Val Loss = 9332.08938
2025-12-29-16-14-51	Epoch 5	Train Loss = 4221.45115, Val Loss = 3113.74786
2025-12-29-16-15-36	Epoch 6	Train Loss = 2807.06223, Val Loss = 3078.27129
2025-12-29-16-16-22	Epoch 7	Train Loss = 2380.44523, Val Loss = 3608.54276
2025-12-29-16-17-07	Epoch 8	Train Loss = 2142.38441, Val Loss = 3051.40236
2025-12-29-16-17-53	Epoch 9	Train Loss = 1921.56675, Val Loss = 2607.99107
2025-12-29-16-18-40	Epoch 10	Train Loss = 1739.93984, Val Loss = 2685.57593
2025-12-29-16-19-25	Epoch 11	Train Loss = 1620.65203, Val Loss = 2471.85723
2025-12-29-16-20-11	Epoch 12	Train Loss = 1538.23032, Val Loss = 2372.91068
2025-12-29-16-20-57	Epoch 13	Train Loss = 1478.57737, Val Loss = 2692.68999
2025-12-29-16-21-42	Epoch 14	Train Loss = 1610.30963, Val Loss = 2381.39328
2025-12-29-16-22-28	Epoch 15	Train Loss = 1334.47207, Val Loss = 6113.67345
2025-12-29-16-23-13	Epoch 16	Train Loss = 1717.04169, Val Loss = 2482.95966
2025-12-29-16-23-59	Epoch 17	Train Loss = 1306.04446, Val Loss = 2366.14865
2025-12-29-16-24-45	Epoch 18	Train Loss = 1272.62725, Val Loss = 2303.33717
2025-12-29-16-25-30	Epoch 19	Train Loss = 1348.78737, Val Loss = 2883.32036
2025-12-29-16-26-16	Epoch 20	Train Loss = 1710.48536, Val Loss = 2643.76245
2025-12-29-16-27-02	Epoch 21	Train Loss = 1216.38840, Val Loss = 2528.75814
2025-12-29-16-27-47	Epoch 22	Train Loss = 1335.15312, Val Loss = 2991.05107
2025-12-29-16-28-33	Epoch 23	Train Loss = 1315.26182, Val Loss = 2212.87494
2025-12-29-16-29-18	Epoch 24	Train Loss = 1150.43148, Val Loss = 2351.49698
2025-12-29-16-30-04	Epoch 25	Train Loss = 1470.15399, Val Loss = 2465.20030
2025-12-29-16-30-49	Epoch 26	Train Loss = 1397.55241, Val Loss = 2308.41035
2025-12-29-16-31-35	Epoch 27	Train Loss = 1555.96922, Val Loss = 2532.52935
2025-12-29-16-32-21	Epoch 28	Train Loss = 1239.91095, Val Loss = 2348.24944
2025-12-29-16-33-06	Epoch 29	Train Loss = 1133.30370, Val Loss = 2584.02876
2025-12-29-16-33-52	Epoch 30	Train Loss = 1276.67761, Val Loss = 2244.38341
2025-12-29-16-34-37	Epoch 31	Train Loss = 1263.52253, Val Loss = 2321.14898
2025-12-29-16-35-23	Epoch 32	Train Loss = 1307.77767, Val Loss = 2465.93208
2025-12-29-16-36-09	Epoch 33	Train Loss = 1212.14594, Val Loss = 2201.74473
2025-12-29-16-36-54	Epoch 34	Train Loss = 1211.96152, Val Loss = 2236.09057
2025-12-29-16-37-40	Epoch 35	Train Loss = 1219.27572, Val Loss = 2716.12010
2025-12-29-16-38-25	Epoch 36	Train Loss = 1164.65978, Val Loss = 2460.30556
2025-12-29-16-39-11	Epoch 37	Train Loss = 1152.49095, Val Loss = 2392.92169
2025-12-29-16-39-56	Epoch 38	Train Loss = 1105.65481, Val Loss = 2317.52302
2025-12-29-16-40-42	Epoch 39	Train Loss = 1245.96366, Val Loss = 2541.63605
2025-12-29-16-41-28	Epoch 40	Train Loss = 1145.91663, Val Loss = 2175.81628
2025-12-29-16-42-13	Epoch 41	Train Loss = 1120.67265, Val Loss = 2447.77649
2025-12-29-16-42-59	Epoch 42	Train Loss = 1099.69356, Val Loss = 2272.05661
2025-12-29-16-43-44	Epoch 43	Train Loss = 1189.81995, Val Loss = 2391.47853
2025-12-29-16-44-30	Epoch 44	Train Loss = 1053.04098, Val Loss = 2907.35241
2025-12-29-16-45-16	Epoch 45	Train Loss = 1158.84605, Val Loss = 2264.44334
2025-12-29-16-46-01	Epoch 46	Train Loss = 1054.61979, Val Loss = 2274.78081
2025-12-29-16-46-47	Epoch 47	Train Loss = 1057.23286, Val Loss = 2186.81348
2025-12-29-16-47-32	Epoch 48	Train Loss = 1273.17886, Val Loss = 2279.95063
2025-12-29-16-48-18	Epoch 49	Train Loss = 1039.23782, Val Loss = 2306.82717
2025-12-29-16-49-04	Epoch 50	Train Loss = 967.57443, Val Loss = 2193.24606
2025-12-29-16-49-49	Epoch 51	Train Loss = 1050.85982, Val Loss = 2103.76362
2025-12-29-16-50-35	Epoch 52	Train Loss = 1098.78973, Val Loss = 2241.32312
2025-12-29-16-51-21	Epoch 53	Train Loss = 1018.65793, Val Loss = 2194.95946
2025-12-29-16-52-06	Epoch 54	Train Loss = 1133.18750, Val Loss = 4118.06391
2025-12-29-16-52-52	Epoch 55	Train Loss = 1086.79203, Val Loss = 2126.33436
2025-12-29-16-53-38	Epoch 56	Train Loss = 1020.82420, Val Loss = 2041.07496
2025-12-29-16-54-23	Epoch 57	Train Loss = 969.97630, Val Loss = 2029.75870
2025-12-29-16-55-09	Epoch 58	Train Loss = 958.66421, Val Loss = 1964.23303
2025-12-29-16-55-55	Epoch 59	Train Loss = 970.21028, Val Loss = 1975.50456
2025-12-29-16-56-40	Epoch 60	Train Loss = 1054.11613, Val Loss = 2474.04970
2025-12-29-16-57-26	Epoch 61	Train Loss = 935.49863, Val Loss = 2161.09927
2025-12-29-16-58-12	Epoch 62	Train Loss = 952.04317, Val Loss = 2022.23505
2025-12-29-16-58-57	Epoch 63	Train Loss = 926.78651, Val Loss = 2001.48189
2025-12-29-16-59-43	Epoch 64	Train Loss = 943.06554, Val Loss = 2173.55743
2025-12-29-17-00-28	Epoch 65	Train Loss = 1148.66495, Val Loss = 1924.77697
2025-12-29-17-01-14	Epoch 66	Train Loss = 1044.54392, Val Loss = 2108.94200
2025-12-29-17-01-59	Epoch 67	Train Loss = 947.44072, Val Loss = 2042.89844
2025-12-29-17-02-45	Epoch 68	Train Loss = 1036.90518, Val Loss = 2027.79616
2025-12-29-17-03-31	Epoch 69	Train Loss = 1025.25697, Val Loss = 2104.78018
2025-12-29-17-04-17	Epoch 70	Train Loss = 923.11438, Val Loss = 1889.00744
2025-12-29-17-05-02	Epoch 71	Train Loss = 938.89540, Val Loss = 1933.97124
2025-12-29-17-05-48	Epoch 72	Train Loss = 928.40205, Val Loss = 2029.20654
2025-12-29-17-06-33	Epoch 73	Train Loss = 925.31255, Val Loss = 1922.44621
2025-12-29-17-07-19	Epoch 74	Train Loss = 903.29142, Val Loss = 1960.89014
2025-12-29-17-08-05	Epoch 75	Train Loss = 926.03203, Val Loss = 2054.03757
2025-12-29-17-08-50	Epoch 76	Train Loss = 896.92515, Val Loss = 2012.50076
2025-12-29-17-09-36	Epoch 77	Train Loss = 902.91117, Val Loss = 1930.31728
2025-12-29-17-10-21	Epoch 78	Train Loss = 904.18442, Val Loss = 1993.80349
2025-12-29-17-11-07	Epoch 79	Train Loss = 940.67115, Val Loss = 1953.27903
2025-12-29-17-11-53	Epoch 80	Train Loss = 874.96062, Val Loss = 1894.92754
2025-12-29-17-12-38	Epoch 81	Train Loss = 991.73331, Val Loss = 1878.33809
2025-12-29-17-13-24	Epoch 82	Train Loss = 889.32358, Val Loss = 1920.06962
2025-12-29-17-14-10	Epoch 83	Train Loss = 882.55313, Val Loss = 1932.60021
2025-12-29-17-14-56	Epoch 84	Train Loss = 894.43813, Val Loss = 2008.19976
2025-12-29-17-15-42	Epoch 85	Train Loss = 848.72021, Val Loss = 2142.49971
2025-12-29-17-16-27	Epoch 86	Train Loss = 871.39459, Val Loss = 1906.87156
2025-12-29-17-17-13	Epoch 87	Train Loss = 867.19605, Val Loss = 1919.39574
2025-12-29-17-17-59	Epoch 88	Train Loss = 900.07236, Val Loss = 2168.47027
2025-12-29-17-18-44	Epoch 89	Train Loss = 1012.83407, Val Loss = 2031.95481
2025-12-29-17-19-30	Epoch 90	Train Loss = 876.09857, Val Loss = 1964.43922
2025-12-29-17-20-16	Epoch 91	Train Loss = 904.50338, Val Loss = 1960.24661
2025-12-29-17-21-02	Epoch 92	Train Loss = 864.52089, Val Loss = 1831.25206
2025-12-29-17-21-47	Epoch 93	Train Loss = 835.51957, Val Loss = 1873.75611
2025-12-29-17-22-33	Epoch 94	Train Loss = 842.31737, Val Loss = 1793.71180
2025-12-29-17-23-19	Epoch 95	Train Loss = 849.34045, Val Loss = 1841.06832
2025-12-29-17-24-04	Epoch 96	Train Loss = 1030.45441, Val Loss = 2419.33236
2025-12-29-17-24-50	Epoch 97	Train Loss = 1020.56409, Val Loss = 1934.35490
2025-12-29-17-25-36	Epoch 98	Train Loss = 872.97802, Val Loss = 1836.60774
2025-12-29-17-26-21	Epoch 99	Train Loss = 853.10319, Val Loss = 1994.28509
2025-12-29-17-27-07	Epoch 100	Train Loss = 846.62804, Val Loss = 1883.67791
2025-12-29-17-27-53	Epoch 101	Train Loss = 811.45195, Val Loss = 1837.04548
2025-12-29-17-28-38	Epoch 102	Train Loss = 840.80340, Val Loss = 1821.14084
2025-12-29-17-29-24	Epoch 103	Train Loss = 838.22085, Val Loss = 1811.49308
2025-12-29-17-30-09	Epoch 104	Train Loss = 822.38945, Val Loss = 2050.87051
2025-12-29-17-30-55	Epoch 105	Train Loss = 895.11709, Val Loss = 2091.07311
2025-12-29-17-31-40	Epoch 106	Train Loss = 824.12720, Val Loss = 1820.88701
2025-12-29-17-32-26	Epoch 107	Train Loss = 807.36552, Val Loss = 1837.84242
2025-12-29-17-33-11	Epoch 108	Train Loss = 828.88252, Val Loss = 1906.67111
2025-12-29-17-33-57	Epoch 109	Train Loss = 830.28479, Val Loss = 1852.36885
2025-12-29-17-34-43	Epoch 110	Train Loss = 835.16559, Val Loss = 1829.43548
2025-12-29-17-35-28	Epoch 111	Train Loss = 828.49056, Val Loss = 1925.69217
2025-12-29-17-36-14	Epoch 112	Train Loss = 805.36239, Val Loss = 1846.88261
2025-12-29-17-36-59	Epoch 113	Train Loss = 792.48516, Val Loss = 1825.59567
2025-12-29-17-37-45	Epoch 114	Train Loss = 817.05821, Val Loss = 1811.21276
2025-12-29-17-38-31	Epoch 115	Train Loss = 780.07425, Val Loss = 1954.24206
2025-12-29-17-39-16	Epoch 116	Train Loss = 802.29268, Val Loss = 1887.20430
2025-12-29-17-40-02	Epoch 117	Train Loss = 773.18750, Val Loss = 1821.51579
2025-12-29-17-40-47	Epoch 118	Train Loss = 777.55658, Val Loss = 1812.66890
2025-12-29-17-41-33	Epoch 119	Train Loss = 891.47724, Val Loss = 2312.64982
2025-12-29-17-42-18	Epoch 120	Train Loss = 837.55883, Val Loss = 1917.67249
2025-12-29-17-43-04	Epoch 121	Train Loss = 797.79758, Val Loss = 1862.58111
2025-12-29-17-43-50	Epoch 122	Train Loss = 780.34598, Val Loss = 1929.38364
2025-12-29-17-44-36	Epoch 123	Train Loss = 779.42162, Val Loss = 1788.08196
2025-12-29-17-45-21	Epoch 124	Train Loss = 796.61528, Val Loss = 1821.23064
2025-12-29-17-46-07	Epoch 125	Train Loss = 776.19571, Val Loss = 1862.41070
2025-12-29-17-46-52	Epoch 126	Train Loss = 767.30342, Val Loss = 1844.94335
2025-12-29-17-47-38	Epoch 127	Train Loss = 789.99715, Val Loss = 1808.05609
2025-12-29-17-48-24	Epoch 128	Train Loss = 769.72486, Val Loss = 1831.35397
2025-12-29-17-49-09	Epoch 129	Train Loss = 766.48881, Val Loss = 1757.99597
2025-12-29-17-49-55	Epoch 130	Train Loss = 854.17811, Val Loss = 1876.60155
2025-12-29-17-50-40	Epoch 131	Train Loss = 759.85321, Val Loss = 1872.09614
2025-12-29-17-51-26	Epoch 132	Train Loss = 776.99242, Val Loss = 1831.38807
2025-12-29-17-52-11	Epoch 133	Train Loss = 779.49601, Val Loss = 2012.74489
2025-12-29-17-52-57	Epoch 134	Train Loss = 779.43671, Val Loss = 1873.83385
2025-12-29-17-53-43	Epoch 135	Train Loss = 776.44832, Val Loss = 1802.06821
2025-12-29-17-54-28	Epoch 136	Train Loss = 770.27745, Val Loss = 1860.71253
2025-12-29-17-55-14	Epoch 137	Train Loss = 771.93435, Val Loss = 1879.82506
2025-12-29-17-55-59	Epoch 138	Train Loss = 760.56054, Val Loss = 1817.75873
2025-12-29-17-56-45	Epoch 139	Train Loss = 780.58059, Val Loss = 1825.02692
2025-12-29-17-57-30	Epoch 140	Train Loss = 762.30861, Val Loss = 1817.71720
2025-12-29-17-58-16	Epoch 141	Train Loss = 769.66468, Val Loss = 1846.98319
2025-12-29-17-59-02	Epoch 142	Train Loss = 760.93532, Val Loss = 1816.02527
2025-12-29-17-59-48	Epoch 143	Train Loss = 1091.58305, Val Loss = 2719.02654
2025-12-29-18-00-33	Epoch 144	Train Loss = 882.09310, Val Loss = 1861.22693
2025-12-29-18-01-19	Epoch 145	Train Loss = 765.13794, Val Loss = 1835.74402
2025-12-29-18-02-05	Epoch 146	Train Loss = 754.84407, Val Loss = 1910.33698
2025-12-29-18-02-51	Epoch 147	Train Loss = 755.63821, Val Loss = 1791.94618
2025-12-29-18-03-36	Epoch 148	Train Loss = 746.99475, Val Loss = 1786.14527
2025-12-29-18-04-22	Epoch 149	Train Loss = 747.85709, Val Loss = 1794.53075
2025-12-29-18-05-07	Epoch 150	Train Loss = 751.20062, Val Loss = 1911.95045
2025-12-29-18-05-53	Epoch 151	Train Loss = 743.74267, Val Loss = 1843.06629
2025-12-29-18-06-39	Epoch 152	Train Loss = 733.02347, Val Loss = 1786.67290
2025-12-29-18-07-24	Epoch 153	Train Loss = 755.34867, Val Loss = 1838.80075
2025-12-29-18-08-10	Epoch 154	Train Loss = 753.77167, Val Loss = 1878.37108
2025-12-29-18-08-55	Epoch 155	Train Loss = 773.60555, Val Loss = 1817.87047
2025-12-29-18-09-41	Epoch 156	Train Loss = 785.47176, Val Loss = 1818.40779
2025-12-29-18-10-26	Epoch 157	Train Loss = 730.04992, Val Loss = 1814.40283
2025-12-29-18-11-12	Epoch 158	Train Loss = 740.64125, Val Loss = 1795.32021
2025-12-29-18-11-58	Epoch 159	Train Loss = 746.41731, Val Loss = 1798.19468
2025-12-29-18-12-43	Epoch 160	Train Loss = 735.57143, Val Loss = 1810.40298
2025-12-29-18-13-28	Epoch 161	Train Loss = 824.36982, Val Loss = 1896.33012
2025-12-29-18-14-14	Epoch 162	Train Loss = 758.40738, Val Loss = 1903.45019
2025-12-29-18-14-59	Epoch 163	Train Loss = 737.45483, Val Loss = 1817.46977
2025-12-29-18-15-45	Epoch 164	Train Loss = 731.61661, Val Loss = 1929.76018
2025-12-29-18-16-31	Epoch 165	Train Loss = 738.48141, Val Loss = 1813.06124
2025-12-29-18-17-16	Epoch 166	Train Loss = 740.59989, Val Loss = 1817.86037
2025-12-29-18-18-02	Epoch 167	Train Loss = 746.41306, Val Loss = 1897.19978
2025-12-29-18-18-48	Epoch 168	Train Loss = 736.97653, Val Loss = 1840.38714
2025-12-29-18-19-33	Epoch 169	Train Loss = 721.50993, Val Loss = 1769.55373
2025-12-29-18-20-19	Epoch 170	Train Loss = 720.42739, Val Loss = 1855.63850
2025-12-29-18-21-04	Epoch 171	Train Loss = 745.29159, Val Loss = 1880.85295
2025-12-29-18-21-50	Epoch 172	Train Loss = 914.65608, Val Loss = 1798.58643
2025-12-29-18-22-35	Epoch 173	Train Loss = 740.71742, Val Loss = 1825.72964
2025-12-29-18-23-21	Epoch 174	Train Loss = 746.87391, Val Loss = 2035.73303
2025-12-29-18-24-06	Epoch 175	Train Loss = 726.43765, Val Loss = 1760.17812
2025-12-29-18-24-52	Epoch 176	Train Loss = 737.01182, Val Loss = 1858.42539
2025-12-29-18-25-37	Epoch 177	Train Loss = 738.86543, Val Loss = 1828.79670
2025-12-29-18-26-23	Epoch 178	Train Loss = 730.23535, Val Loss = 1840.78811
2025-12-29-18-27-08	Epoch 179	Train Loss = 719.92216, Val Loss = 1879.76465
Early stopping at epoch: 179
Best at epoch 129:
Train Loss = 766.48881
Train RMSE = 27.04648, MAE = 17.73924, MAPE = 0.15207
Val Loss = 1757.99597
Val RMSE = 41.80264, MAE = 20.85374, MAPE = 0.17280
Saved Model: ./saved_models/GMAN-PEMS08-2025-12-29-16-11-02.pt
--------- Test ---------
All Steps RMSE = 36.59217, MAE = 19.58184, MAPE = 0.15592
Step  1 RMSE = 34.01025, MAE = 16.72492, MAPE = 0.15196
Step  2 RMSE = 34.76293, MAE = 17.56719, MAPE = 0.15301
Step  3 RMSE = 35.20011, MAE = 17.88319, MAPE = 0.12649
Step  4 RMSE = 35.59045, MAE = 18.32275, MAPE = 0.12783
Step  5 RMSE = 35.97942, MAE = 18.78408, MAPE = 0.12982
Step  6 RMSE = 36.60831, MAE = 19.61388, MAPE = 0.16140
Step  7 RMSE = 36.98685, MAE = 20.07014, MAPE = 0.16702
Step  8 RMSE = 37.39064, MAE = 20.53975, MAPE = 0.17354
Step  9 RMSE = 37.66240, MAE = 20.80758, MAPE = 0.17226
Step 10 RMSE = 37.93181, MAE = 21.12089, MAPE = 0.17332
Step 11 RMSE = 38.19758, MAE = 21.33201, MAPE = 0.16790
Step 12 RMSE = 38.46893, MAE = 22.21595, MAPE = 0.16647

Inference time: 4.91 s
