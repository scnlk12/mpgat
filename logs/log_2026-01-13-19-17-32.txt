{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'exponential', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-13-19-19-45	Epoch 1	Train Loss = 0.62464, Val Loss = 0.14952
2026-01-13-19-21-53	Epoch 2	Train Loss = 0.39090, Val Loss = 0.15806
2026-01-13-19-24-00	Epoch 3	Train Loss = 0.36952, Val Loss = 0.14713
2026-01-13-19-26-08	Epoch 4	Train Loss = 0.36094, Val Loss = 0.14924
2026-01-13-19-28-15	Epoch 5	Train Loss = 0.35820, Val Loss = 0.14489
2026-01-13-19-30-23	Epoch 6	Train Loss = 0.35567, Val Loss = 0.14426
2026-01-13-19-32-30	Epoch 7	Train Loss = 0.35449, Val Loss = 0.14439
2026-01-13-19-34-38	Epoch 8	Train Loss = 0.35488, Val Loss = 0.14428
2026-01-13-19-36-46	Epoch 9	Train Loss = 0.35405, Val Loss = 0.14506
2026-01-13-19-38-53	Epoch 10	Train Loss = 0.35325, Val Loss = 0.14329
2026-01-13-19-41-01	Epoch 11	Train Loss = 0.35207, Val Loss = 0.14344
2026-01-13-19-43-09	Epoch 12	Train Loss = 0.35130, Val Loss = 0.14228
2026-01-13-19-45-17	Epoch 13	Train Loss = 0.35049, Val Loss = 0.14245
2026-01-13-19-47-24	Epoch 14	Train Loss = 0.35029, Val Loss = 0.14135
2026-01-13-19-49-31	Epoch 15	Train Loss = 0.34938, Val Loss = 0.14324
2026-01-13-19-51-39	Epoch 16	Train Loss = 0.34849, Val Loss = 0.13964
2026-01-13-19-53-46	Epoch 17	Train Loss = 0.34764, Val Loss = 0.14101
2026-01-13-19-55-54	Epoch 18	Train Loss = 0.34717, Val Loss = 0.13971
2026-01-13-19-58-01	Epoch 19	Train Loss = 0.34596, Val Loss = 0.13828
2026-01-13-20-00-09	Epoch 20	Train Loss = 0.34515, Val Loss = 0.13835
2026-01-13-20-02-17	Epoch 21	Train Loss = 0.34457, Val Loss = 0.14121
2026-01-13-20-04-24	Epoch 22	Train Loss = 0.34420, Val Loss = 0.13767
2026-01-13-20-06-32	Epoch 23	Train Loss = 0.34387, Val Loss = 0.13761
2026-01-13-20-08-39	Epoch 24	Train Loss = 0.34259, Val Loss = 0.13431
2026-01-13-20-10-46	Epoch 25	Train Loss = 0.34708, Val Loss = 0.13967
2026-01-13-20-12-54	Epoch 26	Train Loss = 0.34604, Val Loss = 0.13837
2026-01-13-20-15-01	Epoch 27	Train Loss = 0.34517, Val Loss = 0.13666
2026-01-13-20-17-08	Epoch 28	Train Loss = 0.34290, Val Loss = 0.13493
2026-01-13-20-19-16	Epoch 29	Train Loss = 0.34189, Val Loss = 0.13409
2026-01-13-20-21-23	Epoch 30	Train Loss = 0.34628, Val Loss = 0.14162
2026-01-13-20-23-31	Epoch 31	Train Loss = 0.34240, Val Loss = 0.13011
2026-01-13-20-25-38	Epoch 32	Train Loss = 0.33355, Val Loss = 0.12705
2026-01-13-20-27-45	Epoch 33	Train Loss = 0.33003, Val Loss = 0.12282
2026-01-13-20-29-52	Epoch 34	Train Loss = 0.32749, Val Loss = 0.12300
2026-01-13-20-32-00	Epoch 35	Train Loss = 0.32684, Val Loss = 0.12613
2026-01-13-20-34-07	Epoch 36	Train Loss = 0.32624, Val Loss = 0.12205
2026-01-13-20-36-14	Epoch 37	Train Loss = 0.32561, Val Loss = 0.12533
2026-01-13-20-38-22	Epoch 38	Train Loss = 0.32518, Val Loss = 0.12152
2026-01-13-20-40-29	Epoch 39	Train Loss = 0.32442, Val Loss = 0.12307
2026-01-13-20-42-36	Epoch 40	Train Loss = 0.32415, Val Loss = 0.12026
2026-01-13-20-44-44	Epoch 41	Train Loss = 0.40306, Val Loss = 0.15727
2026-01-13-20-46-51	Epoch 42	Train Loss = 0.35982, Val Loss = 0.14649
2026-01-13-20-48-58	Epoch 43	Train Loss = 0.35211, Val Loss = 0.14001
2026-01-13-20-51-06	Epoch 44	Train Loss = 0.34440, Val Loss = 0.13383
2026-01-13-20-53-13	Epoch 45	Train Loss = 0.33702, Val Loss = 0.13022
2026-01-13-20-55-20	Epoch 46	Train Loss = 0.33597, Val Loss = 0.13249
2026-01-13-20-57-27	Epoch 47	Train Loss = 0.33402, Val Loss = 0.12983
2026-01-13-20-59-35	Epoch 48	Train Loss = 0.33233, Val Loss = 0.12798
2026-01-13-21-01-42	Epoch 49	Train Loss = 0.33163, Val Loss = 0.12933
2026-01-13-21-03-49	Epoch 50	Train Loss = 0.33033, Val Loss = 0.12698
2026-01-13-21-05-57	Epoch 51	Train Loss = 0.32934, Val Loss = 0.12764
2026-01-13-21-08-04	Epoch 52	Train Loss = 0.32980, Val Loss = 0.12574
2026-01-13-21-10-11	Epoch 53	Train Loss = 0.32812, Val Loss = 0.12686
2026-01-13-21-12-19	Epoch 54	Train Loss = 0.32730, Val Loss = 0.12592
2026-01-13-21-14-26	Epoch 55	Train Loss = 0.32705, Val Loss = 0.12568
2026-01-13-21-16-33	Epoch 56	Train Loss = 0.32711, Val Loss = 0.12477
2026-01-13-21-18-40	Epoch 57	Train Loss = 0.32540, Val Loss = 0.12437
2026-01-13-21-20-48	Epoch 58	Train Loss = 0.32530, Val Loss = 0.12383
2026-01-13-21-22-55	Epoch 59	Train Loss = 0.32394, Val Loss = 0.12286
2026-01-13-21-25-02	Epoch 60	Train Loss = 0.32395, Val Loss = 0.12273
2026-01-13-21-27-09	Epoch 61	Train Loss = 0.32391, Val Loss = 0.12216
2026-01-13-21-29-17	Epoch 62	Train Loss = 0.32255, Val Loss = 0.12221
2026-01-13-21-31-24	Epoch 63	Train Loss = 0.32222, Val Loss = 0.12079
2026-01-13-21-33-31	Epoch 64	Train Loss = 0.32133, Val Loss = 0.12172
2026-01-13-21-35-38	Epoch 65	Train Loss = 0.32076, Val Loss = 0.12122
2026-01-13-21-37-45	Epoch 66	Train Loss = 0.32288, Val Loss = 0.12213
2026-01-13-21-39-53	Epoch 67	Train Loss = 0.32056, Val Loss = 0.12118
2026-01-13-21-42-00	Epoch 68	Train Loss = 0.31988, Val Loss = 0.12046
2026-01-13-21-44-07	Epoch 69	Train Loss = 0.31907, Val Loss = 0.11946
2026-01-13-21-46-15	Epoch 70	Train Loss = 0.31791, Val Loss = 0.12079
2026-01-13-21-48-22	Epoch 71	Train Loss = 0.35474, Val Loss = 0.13402
2026-01-13-21-50-29	Epoch 72	Train Loss = 0.33415, Val Loss = 0.12996
2026-01-13-21-52-36	Epoch 73	Train Loss = 0.33092, Val Loss = 0.13419
2026-01-13-21-54-43	Epoch 74	Train Loss = 0.33085, Val Loss = 0.12812
2026-01-13-21-56-51	Epoch 75	Train Loss = 0.32761, Val Loss = 0.12738
2026-01-13-21-58-58	Epoch 76	Train Loss = 0.32642, Val Loss = 0.12621
2026-01-13-22-01-05	Epoch 77	Train Loss = 0.32636, Val Loss = 0.12561
2026-01-13-22-03-12	Epoch 78	Train Loss = 0.32382, Val Loss = 0.12668
2026-01-13-22-05-20	Epoch 79	Train Loss = 0.32308, Val Loss = 0.12582
2026-01-13-22-07-27	Epoch 80	Train Loss = 0.32176, Val Loss = 0.12514
2026-01-13-22-09-34	Epoch 81	Train Loss = 0.32182, Val Loss = 0.12454
2026-01-13-22-11-41	Epoch 82	Train Loss = 0.32085, Val Loss = 0.12282
2026-01-13-22-13-49	Epoch 83	Train Loss = 0.31981, Val Loss = 0.12449
2026-01-13-22-15-56	Epoch 84	Train Loss = 0.31915, Val Loss = 0.12772
2026-01-13-22-18-03	Epoch 85	Train Loss = 0.31895, Val Loss = 0.12356
2026-01-13-22-20-10	Epoch 86	Train Loss = 0.31777, Val Loss = 0.12186
2026-01-13-22-22-18	Epoch 87	Train Loss = 0.31664, Val Loss = 0.12338
2026-01-13-22-24-25	Epoch 88	Train Loss = 0.31633, Val Loss = 0.12114
2026-01-13-22-26-32	Epoch 89	Train Loss = 0.31500, Val Loss = 0.12180
2026-01-13-22-28-39	Epoch 90	Train Loss = 0.31512, Val Loss = 0.12120
2026-01-13-22-30-47	Epoch 91	Train Loss = 0.31530, Val Loss = 0.12145
2026-01-13-22-32-54	Epoch 92	Train Loss = 0.31337, Val Loss = 0.12151
2026-01-13-22-35-01	Epoch 93	Train Loss = 0.31303, Val Loss = 0.12308
2026-01-13-22-37-08	Epoch 94	Train Loss = 0.31295, Val Loss = 0.12075
2026-01-13-22-39-16	Epoch 95	Train Loss = 0.31213, Val Loss = 0.12097
2026-01-13-22-41-23	Epoch 96	Train Loss = 0.31234, Val Loss = 0.12008
2026-01-13-22-43-30	Epoch 97	Train Loss = 0.31056, Val Loss = 0.12011
2026-01-13-22-45-38	Epoch 98	Train Loss = 0.30949, Val Loss = 0.11992
2026-01-13-22-47-45	Epoch 99	Train Loss = 0.31035, Val Loss = 0.12006
2026-01-13-22-49-52	Epoch 100	Train Loss = 0.30924, Val Loss = 0.12050
2026-01-13-22-52-00	Epoch 101	Train Loss = 0.30911, Val Loss = 0.11998
2026-01-13-22-54-07	Epoch 102	Train Loss = 0.30744, Val Loss = 0.11986
2026-01-13-22-56-14	Epoch 103	Train Loss = 0.30781, Val Loss = 0.11965
2026-01-13-22-58-21	Epoch 104	Train Loss = 0.30770, Val Loss = 0.11886
2026-01-13-23-00-29	Epoch 105	Train Loss = 0.30653, Val Loss = 0.11931
2026-01-13-23-02-36	Epoch 106	Train Loss = 0.30694, Val Loss = 0.11991
2026-01-13-23-04-43	Epoch 107	Train Loss = 0.30721, Val Loss = 0.11929
2026-01-13-23-06-51	Epoch 108	Train Loss = 0.30725, Val Loss = 0.12108
2026-01-13-23-08-58	Epoch 109	Train Loss = 0.30624, Val Loss = 0.11924
2026-01-13-23-11-05	Epoch 110	Train Loss = 0.30491, Val Loss = 0.11820
2026-01-13-23-13-13	Epoch 111	Train Loss = 0.30493, Val Loss = 0.11879
2026-01-13-23-15-20	Epoch 112	Train Loss = 0.30411, Val Loss = 0.11946
2026-01-13-23-17-27	Epoch 113	Train Loss = 0.30389, Val Loss = 0.11838
2026-01-13-23-19-34	Epoch 114	Train Loss = 0.30390, Val Loss = 0.11741
2026-01-13-23-21-42	Epoch 115	Train Loss = 0.30301, Val Loss = 0.11777
2026-01-13-23-23-49	Epoch 116	Train Loss = 0.30273, Val Loss = 0.11722
2026-01-13-23-25-56	Epoch 117	Train Loss = 0.30227, Val Loss = 0.11797
2026-01-13-23-28-03	Epoch 118	Train Loss = 0.30382, Val Loss = 0.11891
2026-01-13-23-30-11	Epoch 119	Train Loss = 0.30145, Val Loss = 0.11723
2026-01-13-23-32-18	Epoch 120	Train Loss = 0.30136, Val Loss = 0.11961
2026-01-13-23-34-25	Epoch 121	Train Loss = 0.30158, Val Loss = 0.11777
2026-01-13-23-36-33	Epoch 122	Train Loss = 0.30117, Val Loss = 0.11736
2026-01-13-23-38-40	Epoch 123	Train Loss = 0.30070, Val Loss = 0.11738
2026-01-13-23-40-47	Epoch 124	Train Loss = 0.30003, Val Loss = 0.11707
2026-01-13-23-42-55	Epoch 125	Train Loss = 0.30024, Val Loss = 0.11729
2026-01-13-23-45-02	Epoch 126	Train Loss = 0.30011, Val Loss = 0.11863
2026-01-13-23-47-09	Epoch 127	Train Loss = 0.29990, Val Loss = 0.11753
2026-01-13-23-49-16	Epoch 128	Train Loss = 0.29918, Val Loss = 0.11768
2026-01-13-23-51-24	Epoch 129	Train Loss = 0.29992, Val Loss = 0.11828
2026-01-13-23-53-31	Epoch 130	Train Loss = 0.29893, Val Loss = 0.11838
2026-01-13-23-55-38	Epoch 131	Train Loss = 0.29865, Val Loss = 0.11830
2026-01-13-23-57-46	Epoch 132	Train Loss = 0.29893, Val Loss = 0.11816
2026-01-13-23-59-53	Epoch 133	Train Loss = 0.29858, Val Loss = 0.11705
2026-01-14-00-02-00	Epoch 134	Train Loss = 0.29794, Val Loss = 0.11641
2026-01-14-00-04-08	Epoch 135	Train Loss = 0.29828, Val Loss = 0.11790
2026-01-14-00-06-15	Epoch 136	Train Loss = 0.29722, Val Loss = 0.11734
2026-01-14-00-08-22	Epoch 137	Train Loss = 0.29721, Val Loss = 0.12113
2026-01-14-00-10-29	Epoch 138	Train Loss = 0.29683, Val Loss = 0.11932
2026-01-14-00-12-36	Epoch 139	Train Loss = 0.29739, Val Loss = 0.11661
2026-01-14-00-14-44	Epoch 140	Train Loss = 0.29741, Val Loss = 0.11739
2026-01-14-00-16-51	Epoch 141	Train Loss = 0.29720, Val Loss = 0.11937
2026-01-14-00-18-58	Epoch 142	Train Loss = 0.29679, Val Loss = 0.11974
2026-01-14-00-21-05	Epoch 143	Train Loss = 0.29575, Val Loss = 0.11875
2026-01-14-00-23-12	Epoch 144	Train Loss = 0.29586, Val Loss = 0.11687
2026-01-14-00-25-20	Epoch 145	Train Loss = 0.29660, Val Loss = 0.11807
2026-01-14-00-27-27	Epoch 146	Train Loss = 0.29622, Val Loss = 0.11594
2026-01-14-00-29-34	Epoch 147	Train Loss = 0.29552, Val Loss = 0.11634
2026-01-14-00-31-41	Epoch 148	Train Loss = 0.29566, Val Loss = 0.11818
2026-01-14-00-33-48	Epoch 149	Train Loss = 0.29507, Val Loss = 0.11744
2026-01-14-00-35-56	Epoch 150	Train Loss = 0.29468, Val Loss = 0.11629
2026-01-14-00-38-03	Epoch 151	Train Loss = 0.29577, Val Loss = 0.11718
2026-01-14-00-40-10	Epoch 152	Train Loss = 0.29618, Val Loss = 0.11781
2026-01-14-00-42-17	Epoch 153	Train Loss = 0.29696, Val Loss = 0.11527
2026-01-14-00-44-24	Epoch 154	Train Loss = 0.29436, Val Loss = 0.11647
2026-01-14-00-46-31	Epoch 155	Train Loss = 0.29485, Val Loss = 0.11630
2026-01-14-00-48-38	Epoch 156	Train Loss = 0.29408, Val Loss = 0.11728
2026-01-14-00-50-45	Epoch 157	Train Loss = 0.29328, Val Loss = 0.11956
2026-01-14-00-52-53	Epoch 158	Train Loss = 0.29491, Val Loss = 0.11801
2026-01-14-00-55-00	Epoch 159	Train Loss = 0.29462, Val Loss = 0.11749
2026-01-14-00-57-07	Epoch 160	Train Loss = 0.29335, Val Loss = 0.11625
2026-01-14-00-59-14	Epoch 161	Train Loss = 0.29311, Val Loss = 0.11820
2026-01-14-01-01-21	Epoch 162	Train Loss = 0.29352, Val Loss = 0.11672
2026-01-14-01-03-28	Epoch 163	Train Loss = 0.29315, Val Loss = 0.11740
2026-01-14-01-05-36	Epoch 164	Train Loss = 0.29384, Val Loss = 0.11678
2026-01-14-01-07-43	Epoch 165	Train Loss = 0.29329, Val Loss = 0.11724
2026-01-14-01-09-50	Epoch 166	Train Loss = 0.29241, Val Loss = 0.11659
2026-01-14-01-11-57	Epoch 167	Train Loss = 0.29342, Val Loss = 0.11797
2026-01-14-01-14-04	Epoch 168	Train Loss = 0.29291, Val Loss = 0.11684
2026-01-14-01-16-11	Epoch 169	Train Loss = 0.29235, Val Loss = 0.11847
2026-01-14-01-18-18	Epoch 170	Train Loss = 0.29215, Val Loss = 0.11850
2026-01-14-01-20-26	Epoch 171	Train Loss = 0.29193, Val Loss = 0.11771
2026-01-14-01-22-33	Epoch 172	Train Loss = 0.29173, Val Loss = 0.11790
2026-01-14-01-24-40	Epoch 173	Train Loss = 0.29186, Val Loss = 0.11810
2026-01-14-01-26-47	Epoch 174	Train Loss = 0.29156, Val Loss = 0.11743
2026-01-14-01-28-54	Epoch 175	Train Loss = 0.29173, Val Loss = 0.11677
2026-01-14-01-31-01	Epoch 176	Train Loss = 0.29091, Val Loss = 0.11670
2026-01-14-01-33-08	Epoch 177	Train Loss = 0.29235, Val Loss = 0.11679
2026-01-14-01-35-15	Epoch 178	Train Loss = 0.29081, Val Loss = 0.11579
2026-01-14-01-37-22	Epoch 179	Train Loss = 0.29151, Val Loss = 0.11834
2026-01-14-01-39-29	Epoch 180	Train Loss = 0.29766, Val Loss = 0.11588
2026-01-14-01-41-37	Epoch 181	Train Loss = 0.29099, Val Loss = 0.11824
2026-01-14-01-43-44	Epoch 182	Train Loss = 0.29255, Val Loss = 0.11660
2026-01-14-01-45-51	Epoch 183	Train Loss = 0.29115, Val Loss = 0.11825
2026-01-14-01-47-58	Epoch 184	Train Loss = 0.29031, Val Loss = 0.11829
2026-01-14-01-50-05	Epoch 185	Train Loss = 0.29025, Val Loss = 0.11874
2026-01-14-01-52-13	Epoch 186	Train Loss = 0.29352, Val Loss = 0.11898
2026-01-14-01-54-20	Epoch 187	Train Loss = 0.29093, Val Loss = 0.11739
2026-01-14-01-56-27	Epoch 188	Train Loss = 0.28971, Val Loss = 0.11759
2026-01-14-01-58-34	Epoch 189	Train Loss = 0.29067, Val Loss = 0.11923
2026-01-14-02-00-41	Epoch 190	Train Loss = 0.28951, Val Loss = 0.11843
2026-01-14-02-02-48	Epoch 191	Train Loss = 0.29047, Val Loss = 0.11746
2026-01-14-02-04-55	Epoch 192	Train Loss = 0.28990, Val Loss = 0.11816
2026-01-14-02-07-03	Epoch 193	Train Loss = 0.28894, Val Loss = 0.11705
2026-01-14-02-09-10	Epoch 194	Train Loss = 0.28910, Val Loss = 0.11720
2026-01-14-02-11-17	Epoch 195	Train Loss = 0.28876, Val Loss = 0.11907
2026-01-14-02-13-24	Epoch 196	Train Loss = 0.29123, Val Loss = 0.11690
2026-01-14-02-15-31	Epoch 197	Train Loss = 0.28959, Val Loss = 0.11662
2026-01-14-02-17-38	Epoch 198	Train Loss = 0.29307, Val Loss = 0.11848
2026-01-14-02-19-45	Epoch 199	Train Loss = 0.28912, Val Loss = 0.11775
2026-01-14-02-21-53	Epoch 200	Train Loss = 0.28844, Val Loss = 0.11620
2026-01-14-02-24-00	Epoch 201	Train Loss = 0.29602, Val Loss = 0.11763
2026-01-14-02-26-07	Epoch 202	Train Loss = 0.29024, Val Loss = 0.11811
2026-01-14-02-28-14	Epoch 203	Train Loss = 0.28946, Val Loss = 0.11614
Early stopping at epoch: 203
Best at epoch 153:
Train Loss = 0.29696
Train RMSE = 271.11606, MAE = 229.94461, MAPE = 14884.35840
Val Loss = 0.11527
Val RMSE = 275.61365, MAE = 234.03314, MAPE = 12200.84863
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-13-19-17-36.pt
--------- Test ---------
All Steps RMSE = 24.43165, MAE = 14.08741, MAPE = 8.13956
Step  1 RMSE = 19.72994, MAE = 11.80872, MAPE = 6.91512
Step  2 RMSE = 21.66595, MAE = 12.75754, MAPE = 7.41149
Step  3 RMSE = 22.50107, MAE = 13.18838, MAPE = 7.67111
Step  4 RMSE = 23.48619, MAE = 13.61829, MAPE = 7.87045
Step  5 RMSE = 24.13811, MAE = 13.91832, MAPE = 8.07178
Step  6 RMSE = 24.77267, MAE = 14.23312, MAPE = 8.22685
Step  7 RMSE = 25.17910, MAE = 14.41831, MAPE = 8.34736
Step  8 RMSE = 25.47214, MAE = 14.71097, MAPE = 8.61821
Step  9 RMSE = 25.90509, MAE = 14.85308, MAPE = 8.57300
Step 10 RMSE = 26.22271, MAE = 14.98987, MAPE = 8.54618
Step 11 RMSE = 26.48689, MAE = 15.18450, MAPE = 8.65000
Step 12 RMSE = 26.58713, MAE = 15.36781, MAPE = 8.77331

Inference time: 12.92 s
