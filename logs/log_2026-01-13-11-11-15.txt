{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'exponential', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-13-11-13-27	Epoch 1	Train Loss = 0.16715, Val Loss = 0.14608
2026-01-13-11-15-35	Epoch 2	Train Loss = 0.12740, Val Loss = 0.14622
2026-01-13-11-17-42	Epoch 3	Train Loss = 0.12699, Val Loss = 0.14458
2026-01-13-11-19-50	Epoch 4	Train Loss = 0.12555, Val Loss = 0.15313
2026-01-13-11-21-57	Epoch 5	Train Loss = 0.12561, Val Loss = 0.14322
2026-01-13-11-24-05	Epoch 6	Train Loss = 0.12411, Val Loss = 0.14451
2026-01-13-11-26-13	Epoch 7	Train Loss = 0.12255, Val Loss = 0.14063
2026-01-13-11-28-20	Epoch 8	Train Loss = 0.11882, Val Loss = 0.13275
2026-01-13-11-30-28	Epoch 9	Train Loss = 0.11032, Val Loss = 0.12855
2026-01-13-11-32-35	Epoch 10	Train Loss = 0.10761, Val Loss = 0.12713
2026-01-13-11-34-43	Epoch 11	Train Loss = 0.10470, Val Loss = 0.12431
2026-01-13-11-36-50	Epoch 12	Train Loss = 0.10570, Val Loss = 0.12712
2026-01-13-11-38-58	Epoch 13	Train Loss = 0.10509, Val Loss = 0.12461
2026-01-13-11-41-05	Epoch 14	Train Loss = 0.10525, Val Loss = 0.12537
2026-01-13-11-43-13	Epoch 15	Train Loss = 0.10734, Val Loss = 0.13062
2026-01-13-11-45-20	Epoch 16	Train Loss = 0.10610, Val Loss = 0.12699
2026-01-13-11-47-28	Epoch 17	Train Loss = 0.10908, Val Loss = 0.12764
2026-01-13-11-49-35	Epoch 18	Train Loss = 0.10649, Val Loss = 0.12757
2026-01-13-11-51-42	Epoch 19	Train Loss = 0.10390, Val Loss = 0.12426
2026-01-13-11-53-50	Epoch 20	Train Loss = 0.10394, Val Loss = 0.12491
2026-01-13-11-55-57	Epoch 21	Train Loss = 0.10254, Val Loss = 0.12638
2026-01-13-11-58-05	Epoch 22	Train Loss = 0.10146, Val Loss = 0.12151
2026-01-13-12-00-12	Epoch 23	Train Loss = 0.10049, Val Loss = 0.12356
2026-01-13-12-02-20	Epoch 24	Train Loss = 0.10119, Val Loss = 0.12047
2026-01-13-12-04-27	Epoch 25	Train Loss = 0.09997, Val Loss = 0.12035
2026-01-13-12-06-34	Epoch 26	Train Loss = 0.09906, Val Loss = 0.12013
2026-01-13-12-08-41	Epoch 27	Train Loss = 0.09933, Val Loss = 0.11950
2026-01-13-12-10-49	Epoch 28	Train Loss = 0.09868, Val Loss = 0.12014
2026-01-13-12-12-56	Epoch 29	Train Loss = 0.09824, Val Loss = 0.11860
2026-01-13-12-15-03	Epoch 30	Train Loss = 0.09819, Val Loss = 0.11922
2026-01-13-12-17-11	Epoch 31	Train Loss = 0.09807, Val Loss = 0.11879
2026-01-13-12-19-18	Epoch 32	Train Loss = 0.09743, Val Loss = 0.11851
2026-01-13-12-21-25	Epoch 33	Train Loss = 0.09731, Val Loss = 0.11787
2026-01-13-12-23-33	Epoch 34	Train Loss = 0.09691, Val Loss = 0.11786
2026-01-13-12-25-40	Epoch 35	Train Loss = 0.09646, Val Loss = 0.11861
2026-01-13-12-27-47	Epoch 36	Train Loss = 0.09651, Val Loss = 0.11683
2026-01-13-12-29-54	Epoch 37	Train Loss = 0.09589, Val Loss = 0.11620
2026-01-13-12-32-02	Epoch 38	Train Loss = 0.09566, Val Loss = 0.11642
2026-01-13-12-34-09	Epoch 39	Train Loss = 0.09551, Val Loss = 0.11577
2026-01-13-12-36-16	Epoch 40	Train Loss = 0.09526, Val Loss = 0.11764
2026-01-13-12-38-24	Epoch 41	Train Loss = 0.11907, Val Loss = 0.12803
2026-01-13-12-40-31	Epoch 42	Train Loss = 0.10441, Val Loss = 0.12565
2026-01-13-12-42-38	Epoch 43	Train Loss = 0.10233, Val Loss = 0.12420
2026-01-13-12-44-45	Epoch 44	Train Loss = 0.10267, Val Loss = 0.12739
2026-01-13-12-46-53	Epoch 45	Train Loss = 0.10232, Val Loss = 0.12400
2026-01-13-12-49-00	Epoch 46	Train Loss = 0.10076, Val Loss = 0.12308
2026-01-13-12-51-07	Epoch 47	Train Loss = 0.10059, Val Loss = 0.12458
2026-01-13-12-53-14	Epoch 48	Train Loss = 0.10100, Val Loss = 0.12169
2026-01-13-12-55-21	Epoch 49	Train Loss = 0.10039, Val Loss = 0.12407
2026-01-13-12-57-29	Epoch 50	Train Loss = 0.10162, Val Loss = 0.12178
2026-01-13-12-59-36	Epoch 51	Train Loss = 0.09910, Val Loss = 0.12148
2026-01-13-13-01-43	Epoch 52	Train Loss = 0.09840, Val Loss = 0.12172
2026-01-13-13-03-50	Epoch 53	Train Loss = 0.09831, Val Loss = 0.12087
2026-01-13-13-05-57	Epoch 54	Train Loss = 0.10088, Val Loss = 0.12019
2026-01-13-13-08-05	Epoch 55	Train Loss = 0.09755, Val Loss = 0.12021
2026-01-13-13-10-12	Epoch 56	Train Loss = 0.09658, Val Loss = 0.11817
2026-01-13-13-12-19	Epoch 57	Train Loss = 0.09600, Val Loss = 0.11757
2026-01-13-13-14-26	Epoch 58	Train Loss = 0.09601, Val Loss = 0.11723
2026-01-13-13-16-33	Epoch 59	Train Loss = 0.09559, Val Loss = 0.11738
2026-01-13-13-18-41	Epoch 60	Train Loss = 0.09497, Val Loss = 0.11730
2026-01-13-13-20-48	Epoch 61	Train Loss = 0.09505, Val Loss = 0.11672
2026-01-13-13-22-55	Epoch 62	Train Loss = 0.09448, Val Loss = 0.11700
2026-01-13-13-25-02	Epoch 63	Train Loss = 0.09395, Val Loss = 0.11591
2026-01-13-13-27-09	Epoch 64	Train Loss = 0.09494, Val Loss = 0.11721
2026-01-13-13-29-16	Epoch 65	Train Loss = 0.09408, Val Loss = 0.11746
2026-01-13-13-31-24	Epoch 66	Train Loss = 0.09416, Val Loss = 0.11774
2026-01-13-13-33-31	Epoch 67	Train Loss = 0.09320, Val Loss = 0.11588
2026-01-13-13-35-38	Epoch 68	Train Loss = 0.09236, Val Loss = 0.11636
2026-01-13-13-37-45	Epoch 69	Train Loss = 0.09273, Val Loss = 0.11473
2026-01-13-13-39-52	Epoch 70	Train Loss = 0.09440, Val Loss = 0.11522
2026-01-13-13-41-59	Epoch 71	Train Loss = 0.11218, Val Loss = 0.12734
2026-01-13-13-44-07	Epoch 72	Train Loss = 0.10268, Val Loss = 0.12746
2026-01-13-13-46-14	Epoch 73	Train Loss = 0.11087, Val Loss = 0.13932
2026-01-13-13-48-21	Epoch 74	Train Loss = 0.10699, Val Loss = 0.12541
2026-01-13-13-50-28	Epoch 75	Train Loss = 0.10086, Val Loss = 0.12390
2026-01-13-13-52-35	Epoch 76	Train Loss = 0.09934, Val Loss = 0.12264
2026-01-13-13-54-43	Epoch 77	Train Loss = 0.09910, Val Loss = 0.12205
2026-01-13-13-56-50	Epoch 78	Train Loss = 0.09796, Val Loss = 0.12293
2026-01-13-13-58-57	Epoch 79	Train Loss = 0.09699, Val Loss = 0.12188
2026-01-13-14-01-04	Epoch 80	Train Loss = 0.09770, Val Loss = 0.12390
2026-01-13-14-03-11	Epoch 81	Train Loss = 0.09747, Val Loss = 0.12239
2026-01-13-14-05-19	Epoch 82	Train Loss = 0.09628, Val Loss = 0.12020
2026-01-13-14-07-26	Epoch 83	Train Loss = 0.09550, Val Loss = 0.12145
2026-01-13-14-09-33	Epoch 84	Train Loss = 0.09529, Val Loss = 0.12177
2026-01-13-14-11-40	Epoch 85	Train Loss = 0.09458, Val Loss = 0.12023
2026-01-13-14-13-47	Epoch 86	Train Loss = 0.09485, Val Loss = 0.12014
2026-01-13-14-15-54	Epoch 87	Train Loss = 0.09749, Val Loss = 0.12463
2026-01-13-14-18-02	Epoch 88	Train Loss = 0.09832, Val Loss = 0.12321
2026-01-13-14-20-09	Epoch 89	Train Loss = 0.09649, Val Loss = 0.12198
2026-01-13-14-22-16	Epoch 90	Train Loss = 0.09594, Val Loss = 0.12230
2026-01-13-14-24-23	Epoch 91	Train Loss = 0.09610, Val Loss = 0.12397
2026-01-13-14-26-30	Epoch 92	Train Loss = 0.09432, Val Loss = 0.11968
2026-01-13-14-28-37	Epoch 93	Train Loss = 0.09322, Val Loss = 0.12050
2026-01-13-14-30-45	Epoch 94	Train Loss = 0.09467, Val Loss = 0.12138
2026-01-13-14-32-52	Epoch 95	Train Loss = 0.09515, Val Loss = 0.12020
2026-01-13-14-34-59	Epoch 96	Train Loss = 0.09355, Val Loss = 0.11937
2026-01-13-14-37-06	Epoch 97	Train Loss = 0.09209, Val Loss = 0.11872
2026-01-13-14-39-13	Epoch 98	Train Loss = 0.09176, Val Loss = 0.13376
2026-01-13-14-41-20	Epoch 99	Train Loss = 0.10120, Val Loss = 0.12224
2026-01-13-14-43-28	Epoch 100	Train Loss = 0.09416, Val Loss = 0.12098
2026-01-13-14-45-35	Epoch 101	Train Loss = 0.09228, Val Loss = 0.12161
2026-01-13-14-47-42	Epoch 102	Train Loss = 0.09244, Val Loss = 0.12358
2026-01-13-14-49-49	Epoch 103	Train Loss = 0.09174, Val Loss = 0.12283
2026-01-13-14-51-56	Epoch 104	Train Loss = 0.09376, Val Loss = 0.12228
2026-01-13-14-54-04	Epoch 105	Train Loss = 0.09995, Val Loss = 0.12505
2026-01-13-14-56-11	Epoch 106	Train Loss = 0.09381, Val Loss = 0.12136
2026-01-13-14-58-18	Epoch 107	Train Loss = 0.09498, Val Loss = 0.12393
2026-01-13-15-00-25	Epoch 108	Train Loss = 0.09432, Val Loss = 0.12042
2026-01-13-15-02-32	Epoch 109	Train Loss = 0.09197, Val Loss = 0.12066
2026-01-13-15-04-40	Epoch 110	Train Loss = 0.09085, Val Loss = 0.11951
2026-01-13-15-06-47	Epoch 111	Train Loss = 0.09012, Val Loss = 0.11846
2026-01-13-15-08-54	Epoch 112	Train Loss = 0.08956, Val Loss = 0.11934
2026-01-13-15-11-01	Epoch 113	Train Loss = 0.08974, Val Loss = 0.11934
2026-01-13-15-13-09	Epoch 114	Train Loss = 0.08942, Val Loss = 0.11893
2026-01-13-15-15-16	Epoch 115	Train Loss = 0.08873, Val Loss = 0.11973
2026-01-13-15-17-23	Epoch 116	Train Loss = 0.08899, Val Loss = 0.11930
2026-01-13-15-19-30	Epoch 117	Train Loss = 0.08853, Val Loss = 0.11982
2026-01-13-15-21-37	Epoch 118	Train Loss = 0.08933, Val Loss = 0.12009
2026-01-13-15-23-44	Epoch 119	Train Loss = 0.08826, Val Loss = 0.11848
2026-01-13-15-25-52	Epoch 120	Train Loss = 0.08786, Val Loss = 0.11824
2026-01-13-15-27-59	Epoch 121	Train Loss = 0.08752, Val Loss = 0.11809
2026-01-13-15-30-06	Epoch 122	Train Loss = 0.08748, Val Loss = 0.11945
2026-01-13-15-32-13	Epoch 123	Train Loss = 0.08758, Val Loss = 0.11893
2026-01-13-15-34-20	Epoch 124	Train Loss = 0.08696, Val Loss = 0.11866
2026-01-13-15-36-27	Epoch 125	Train Loss = 0.08675, Val Loss = 0.11989
2026-01-13-15-38-35	Epoch 126	Train Loss = 0.08709, Val Loss = 0.11912
2026-01-13-15-40-42	Epoch 127	Train Loss = 0.08632, Val Loss = 0.11918
2026-01-13-15-42-49	Epoch 128	Train Loss = 0.08633, Val Loss = 0.11739
2026-01-13-15-44-56	Epoch 129	Train Loss = 0.08587, Val Loss = 0.11720
2026-01-13-15-47-03	Epoch 130	Train Loss = 0.08566, Val Loss = 0.12046
2026-01-13-15-49-10	Epoch 131	Train Loss = 0.08716, Val Loss = 0.12114
2026-01-13-15-51-18	Epoch 132	Train Loss = 0.10132, Val Loss = 0.12827
2026-01-13-15-53-25	Epoch 133	Train Loss = 0.09540, Val Loss = 0.12068
2026-01-13-15-55-32	Epoch 134	Train Loss = 0.09101, Val Loss = 0.12046
2026-01-13-15-57-39	Epoch 135	Train Loss = 0.09182, Val Loss = 0.11957
2026-01-13-15-59-46	Epoch 136	Train Loss = 0.08889, Val Loss = 0.11873
2026-01-13-16-01-53	Epoch 137	Train Loss = 0.08745, Val Loss = 0.11990
2026-01-13-16-04-01	Epoch 138	Train Loss = 0.08856, Val Loss = 0.13364
2026-01-13-16-06-08	Epoch 139	Train Loss = 0.09563, Val Loss = 0.11974
2026-01-13-16-08-15	Epoch 140	Train Loss = 0.08855, Val Loss = 0.11872
2026-01-13-16-10-22	Epoch 141	Train Loss = 0.08930, Val Loss = 0.12213
2026-01-13-16-12-29	Epoch 142	Train Loss = 0.08722, Val Loss = 0.11874
2026-01-13-16-14-36	Epoch 143	Train Loss = 0.09009, Val Loss = 0.11905
2026-01-13-16-16-44	Epoch 144	Train Loss = 0.08865, Val Loss = 0.12039
2026-01-13-16-18-51	Epoch 145	Train Loss = 0.08679, Val Loss = 0.12009
2026-01-13-16-20-58	Epoch 146	Train Loss = 0.08697, Val Loss = 0.12163
2026-01-13-16-23-05	Epoch 147	Train Loss = 0.08681, Val Loss = 0.11860
2026-01-13-16-25-12	Epoch 148	Train Loss = 0.08664, Val Loss = 0.12023
2026-01-13-16-27-19	Epoch 149	Train Loss = 0.08666, Val Loss = 0.11908
2026-01-13-16-29-26	Epoch 150	Train Loss = 0.08606, Val Loss = 0.11791
2026-01-13-16-31-33	Epoch 151	Train Loss = 0.08594, Val Loss = 0.11859
2026-01-13-16-33-41	Epoch 152	Train Loss = 0.08516, Val Loss = 0.11962
2026-01-13-16-35-48	Epoch 153	Train Loss = 0.08520, Val Loss = 0.11782
2026-01-13-16-37-55	Epoch 154	Train Loss = 0.08614, Val Loss = 0.11989
2026-01-13-16-40-02	Epoch 155	Train Loss = 0.08510, Val Loss = 0.11994
2026-01-13-16-42-09	Epoch 156	Train Loss = 0.08441, Val Loss = 0.11865
2026-01-13-16-44-16	Epoch 157	Train Loss = 0.08370, Val Loss = 0.11829
2026-01-13-16-46-23	Epoch 158	Train Loss = 0.08363, Val Loss = 0.12285
2026-01-13-16-48-31	Epoch 159	Train Loss = 0.08426, Val Loss = 0.11934
2026-01-13-16-50-38	Epoch 160	Train Loss = 0.08519, Val Loss = 0.12256
2026-01-13-16-52-45	Epoch 161	Train Loss = 0.08694, Val Loss = 0.11983
2026-01-13-16-54-52	Epoch 162	Train Loss = 0.08451, Val Loss = 0.11895
2026-01-13-16-56-59	Epoch 163	Train Loss = 0.08403, Val Loss = 0.11896
2026-01-13-16-59-06	Epoch 164	Train Loss = 0.08396, Val Loss = 0.11980
2026-01-13-17-01-14	Epoch 165	Train Loss = 0.08304, Val Loss = 0.11877
2026-01-13-17-03-21	Epoch 166	Train Loss = 0.08387, Val Loss = 0.11955
2026-01-13-17-05-28	Epoch 167	Train Loss = 0.08290, Val Loss = 0.11916
2026-01-13-17-07-35	Epoch 168	Train Loss = 0.08274, Val Loss = 0.12014
2026-01-13-17-09-42	Epoch 169	Train Loss = 0.08300, Val Loss = 0.11877
2026-01-13-17-11-49	Epoch 170	Train Loss = 0.08230, Val Loss = 0.12082
2026-01-13-17-13-56	Epoch 171	Train Loss = 0.08271, Val Loss = 0.12018
2026-01-13-17-16-03	Epoch 172	Train Loss = 0.08267, Val Loss = 0.12200
2026-01-13-17-18-10	Epoch 173	Train Loss = 0.08309, Val Loss = 0.11934
2026-01-13-17-20-17	Epoch 174	Train Loss = 0.08225, Val Loss = 0.12022
2026-01-13-17-22-25	Epoch 175	Train Loss = 0.08310, Val Loss = 0.12128
2026-01-13-17-24-32	Epoch 176	Train Loss = 0.08201, Val Loss = 0.12018
2026-01-13-17-26-39	Epoch 177	Train Loss = 0.08155, Val Loss = 0.11988
2026-01-13-17-28-46	Epoch 178	Train Loss = 0.08161, Val Loss = 0.11990
2026-01-13-17-30-53	Epoch 179	Train Loss = 0.08160, Val Loss = 0.12054
Early stopping at epoch: 179
Best at epoch 129:
Train Loss = 0.08587
Train RMSE = 271.16052, MAE = 229.86115, MAPE = 14734.61035
Val Loss = 0.11720
Val RMSE = 275.78424, MAE = 233.93021, MAPE = 13079.00879
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-13-11-11-19.pt
--------- Test ---------
All Steps RMSE = 24.94452, MAE = 14.27961, MAPE = 8.24184
Step  1 RMSE = 19.47581, MAE = 11.77442, MAPE = 6.90948
Step  2 RMSE = 21.53489, MAE = 12.77755, MAPE = 7.39202
Step  3 RMSE = 22.97991, MAE = 13.33679, MAPE = 7.65769
Step  4 RMSE = 23.73336, MAE = 13.77518, MAPE = 7.92154
Step  5 RMSE = 24.34717, MAE = 14.02883, MAPE = 8.09630
Step  6 RMSE = 25.24454, MAE = 14.39439, MAPE = 8.23054
Step  7 RMSE = 25.59428, MAE = 14.59557, MAPE = 8.44238
Step  8 RMSE = 26.49026, MAE = 15.03230, MAPE = 8.67023
Step  9 RMSE = 26.73145, MAE = 15.15401, MAPE = 8.74537
Step 10 RMSE = 26.87061, MAE = 15.30559, MAPE = 8.84394
Step 11 RMSE = 27.11872, MAE = 15.43263, MAPE = 8.90382
Step 12 RMSE = 27.81091, MAE = 15.74807, MAPE = 9.08898

Inference time: 12.92 s
