{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 100, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'huber', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'progressive', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-07-10-49-27	Epoch 1	Train Loss = 0.03323, Val Loss = 0.03664
2026-01-07-10-51-34	Epoch 2	Train Loss = 0.01890, Val Loss = 0.03676
2026-01-07-10-53-41	Epoch 3	Train Loss = 0.01871, Val Loss = 0.03626
2026-01-07-10-55-48	Epoch 4	Train Loss = 0.01861, Val Loss = 0.03644
2026-01-07-10-57-55	Epoch 5	Train Loss = 0.01847, Val Loss = 0.03577
2026-01-07-11-00-02	Epoch 6	Train Loss = 0.01775, Val Loss = 0.03315
2026-01-07-11-02-08	Epoch 7	Train Loss = 0.01510, Val Loss = 0.03218
2026-01-07-11-04-15	Epoch 8	Train Loss = 0.01426, Val Loss = 0.03165
2026-01-07-11-06-22	Epoch 9	Train Loss = 0.01400, Val Loss = 0.03117
2026-01-07-11-08-30	Epoch 10	Train Loss = 0.01335, Val Loss = 0.03098
2026-01-07-11-10-37	Epoch 11	Train Loss = 0.01322, Val Loss = 0.03098
2026-01-07-11-12-44	Epoch 12	Train Loss = 0.01313, Val Loss = 0.03138
2026-01-07-11-14-51	Epoch 13	Train Loss = 0.01289, Val Loss = 0.03112
2026-01-07-11-16-58	Epoch 14	Train Loss = 0.01267, Val Loss = 0.03061
2026-01-07-11-19-05	Epoch 15	Train Loss = 0.01257, Val Loss = 0.03029
2026-01-07-11-21-12	Epoch 16	Train Loss = 0.01239, Val Loss = 0.03034
2026-01-07-11-23-19	Epoch 17	Train Loss = 0.01233, Val Loss = 0.03032
2026-01-07-11-25-26	Epoch 18	Train Loss = 0.01220, Val Loss = 0.03044
2026-01-07-11-27-32	Epoch 19	Train Loss = 0.01218, Val Loss = 0.02992
2026-01-07-11-29-39	Epoch 20	Train Loss = 0.01207, Val Loss = 0.03046
2026-01-07-11-31-46	Epoch 21	Train Loss = 0.05015, Val Loss = 0.03555
2026-01-07-11-33-53	Epoch 22	Train Loss = 0.01579, Val Loss = 0.03285
2026-01-07-11-36-00	Epoch 23	Train Loss = 0.01445, Val Loss = 0.03211
2026-01-07-11-38-07	Epoch 24	Train Loss = 0.01396, Val Loss = 0.03164
2026-01-07-11-40-14	Epoch 25	Train Loss = 0.01373, Val Loss = 0.03139
2026-01-07-11-42-21	Epoch 26	Train Loss = 0.01348, Val Loss = 0.03151
2026-01-07-11-44-28	Epoch 27	Train Loss = 0.01321, Val Loss = 0.03130
2026-01-07-11-46-35	Epoch 28	Train Loss = 0.01311, Val Loss = 0.03127
2026-01-07-11-48-42	Epoch 29	Train Loss = 0.01299, Val Loss = 0.03106
2026-01-07-11-50-49	Epoch 30	Train Loss = 0.01285, Val Loss = 0.03125
2026-01-07-11-52-56	Epoch 31	Train Loss = 0.01266, Val Loss = 0.03086
2026-01-07-11-55-03	Epoch 32	Train Loss = 0.01248, Val Loss = 0.03093
2026-01-07-11-57-10	Epoch 33	Train Loss = 0.01243, Val Loss = 0.03116
2026-01-07-11-59-16	Epoch 34	Train Loss = 0.01229, Val Loss = 0.03118
2026-01-07-12-01-23	Epoch 35	Train Loss = 0.01226, Val Loss = 0.03090
2026-01-07-12-03-30	Epoch 36	Train Loss = 0.01222, Val Loss = 0.03085
2026-01-07-12-05-37	Epoch 37	Train Loss = 0.01208, Val Loss = 0.03092
2026-01-07-12-07-44	Epoch 38	Train Loss = 0.01199, Val Loss = 0.03127
2026-01-07-12-09-51	Epoch 39	Train Loss = 0.01194, Val Loss = 0.03126
2026-01-07-12-11-58	Epoch 40	Train Loss = 0.01186, Val Loss = 0.03088
2026-01-07-12-14-05	Epoch 41	Train Loss = 0.02323, Val Loss = 0.03336
2026-01-07-12-16-12	Epoch 42	Train Loss = 0.01426, Val Loss = 0.03311
2026-01-07-12-18-18	Epoch 43	Train Loss = 0.01371, Val Loss = 0.03307
2026-01-07-12-20-25	Epoch 44	Train Loss = 0.01353, Val Loss = 0.03308
2026-01-07-12-22-32	Epoch 45	Train Loss = 0.01332, Val Loss = 0.03309
2026-01-07-12-24-39	Epoch 46	Train Loss = 0.01321, Val Loss = 0.03353
2026-01-07-12-26-46	Epoch 47	Train Loss = 0.01305, Val Loss = 0.03302
2026-01-07-12-28-53	Epoch 48	Train Loss = 0.01298, Val Loss = 0.03276
2026-01-07-12-31-00	Epoch 49	Train Loss = 0.01275, Val Loss = 0.03363
2026-01-07-12-33-06	Epoch 50	Train Loss = 0.01273, Val Loss = 0.03329
2026-01-07-12-35-13	Epoch 51	Train Loss = 0.01254, Val Loss = 0.03338
2026-01-07-12-37-20	Epoch 52	Train Loss = 0.01250, Val Loss = 0.03304
2026-01-07-12-39-27	Epoch 53	Train Loss = 0.01236, Val Loss = 0.03304
2026-01-07-12-41-34	Epoch 54	Train Loss = 0.01223, Val Loss = 0.03318
2026-01-07-12-43-41	Epoch 55	Train Loss = 0.01216, Val Loss = 0.03317
2026-01-07-12-45-47	Epoch 56	Train Loss = 0.01207, Val Loss = 0.03315
2026-01-07-12-47-54	Epoch 57	Train Loss = 0.01206, Val Loss = 0.03332
2026-01-07-12-50-01	Epoch 58	Train Loss = 0.01188, Val Loss = 0.03349
2026-01-07-12-52-08	Epoch 59	Train Loss = 0.01180, Val Loss = 0.03343
2026-01-07-12-54-15	Epoch 60	Train Loss = 0.01184, Val Loss = 0.03333
2026-01-07-12-56-22	Epoch 61	Train Loss = 0.01165, Val Loss = 0.03327
2026-01-07-12-58-28	Epoch 62	Train Loss = 0.01159, Val Loss = 0.03376
2026-01-07-13-00-35	Epoch 63	Train Loss = 0.01153, Val Loss = 0.03366
2026-01-07-13-02-42	Epoch 64	Train Loss = 0.01136, Val Loss = 0.03341
2026-01-07-13-04-49	Epoch 65	Train Loss = 0.01134, Val Loss = 0.03359
2026-01-07-13-06-56	Epoch 66	Train Loss = 0.01130, Val Loss = 0.03357
2026-01-07-13-09-02	Epoch 67	Train Loss = 0.01118, Val Loss = 0.03381
2026-01-07-13-11-09	Epoch 68	Train Loss = 0.01120, Val Loss = 0.03336
2026-01-07-13-13-16	Epoch 69	Train Loss = 0.01107, Val Loss = 0.03340
2026-01-07-13-15-23	Epoch 70	Train Loss = 0.01106, Val Loss = 0.03446
2026-01-07-13-17-29	Epoch 71	Train Loss = 0.01095, Val Loss = 0.03367
2026-01-07-13-19-36	Epoch 72	Train Loss = 0.01094, Val Loss = 0.03385
2026-01-07-13-21-43	Epoch 73	Train Loss = 0.01088, Val Loss = 0.03388
2026-01-07-13-23-50	Epoch 74	Train Loss = 0.01074, Val Loss = 0.03403
2026-01-07-13-25-56	Epoch 75	Train Loss = 0.01064, Val Loss = 0.03341
2026-01-07-13-28-03	Epoch 76	Train Loss = 0.01065, Val Loss = 0.03365
2026-01-07-13-30-10	Epoch 77	Train Loss = 0.01057, Val Loss = 0.03411
2026-01-07-13-32-17	Epoch 78	Train Loss = 0.01049, Val Loss = 0.03389
2026-01-07-13-34-23	Epoch 79	Train Loss = 0.01046, Val Loss = 0.03439
2026-01-07-13-36-30	Epoch 80	Train Loss = 0.01042, Val Loss = 0.03404
2026-01-07-13-38-37	Epoch 81	Train Loss = 0.01034, Val Loss = 0.03400
2026-01-07-13-40-44	Epoch 82	Train Loss = 0.01030, Val Loss = 0.03404
2026-01-07-13-42-51	Epoch 83	Train Loss = 0.01032, Val Loss = 0.03420
2026-01-07-13-44-57	Epoch 84	Train Loss = 0.01018, Val Loss = 0.03400
2026-01-07-13-47-04	Epoch 85	Train Loss = 0.01008, Val Loss = 0.03459
2026-01-07-13-49-11	Epoch 86	Train Loss = 0.01007, Val Loss = 0.03418
2026-01-07-13-51-17	Epoch 87	Train Loss = 0.00993, Val Loss = 0.03429
2026-01-07-13-53-24	Epoch 88	Train Loss = 0.00995, Val Loss = 0.03407
2026-01-07-13-55-31	Epoch 89	Train Loss = 0.00991, Val Loss = 0.03408
2026-01-07-13-57-38	Epoch 90	Train Loss = 0.00989, Val Loss = 0.03458
2026-01-07-13-59-45	Epoch 91	Train Loss = 0.00978, Val Loss = 0.03428
2026-01-07-14-01-52	Epoch 92	Train Loss = 0.00975, Val Loss = 0.03439
2026-01-07-14-03-58	Epoch 93	Train Loss = 0.00973, Val Loss = 0.03417
2026-01-07-14-06-05	Epoch 94	Train Loss = 0.00964, Val Loss = 0.03406
2026-01-07-14-08-12	Epoch 95	Train Loss = 0.00966, Val Loss = 0.03425
2026-01-07-14-10-18	Epoch 96	Train Loss = 0.00957, Val Loss = 0.03397
2026-01-07-14-12-25	Epoch 97	Train Loss = 0.00955, Val Loss = 0.03357
2026-01-07-14-14-32	Epoch 98	Train Loss = 0.00948, Val Loss = 0.03414
2026-01-07-14-16-39	Epoch 99	Train Loss = 0.00942, Val Loss = 0.03388
2026-01-07-14-18-46	Epoch 100	Train Loss = 0.00942, Val Loss = 0.03430
2026-01-07-14-20-52	Epoch 101	Train Loss = 0.00942, Val Loss = 0.03435
2026-01-07-14-22-59	Epoch 102	Train Loss = 0.00925, Val Loss = 0.03423
2026-01-07-14-25-06	Epoch 103	Train Loss = 0.00926, Val Loss = 0.03467
2026-01-07-14-27-13	Epoch 104	Train Loss = 0.00922, Val Loss = 0.03487
2026-01-07-14-29-20	Epoch 105	Train Loss = 0.00918, Val Loss = 0.03449
2026-01-07-14-31-26	Epoch 106	Train Loss = 0.00913, Val Loss = 0.03434
2026-01-07-14-33-33	Epoch 107	Train Loss = 0.00906, Val Loss = 0.03492
2026-01-07-14-35-40	Epoch 108	Train Loss = 0.00900, Val Loss = 0.03417
2026-01-07-14-37-46	Epoch 109	Train Loss = 0.00907, Val Loss = 0.03453
2026-01-07-14-39-53	Epoch 110	Train Loss = 0.00908, Val Loss = 0.03484
2026-01-07-14-42-00	Epoch 111	Train Loss = 0.00894, Val Loss = 0.03501
2026-01-07-14-44-07	Epoch 112	Train Loss = 0.00886, Val Loss = 0.03438
2026-01-07-14-46-13	Epoch 113	Train Loss = 0.00885, Val Loss = 0.03482
2026-01-07-14-48-20	Epoch 114	Train Loss = 0.00883, Val Loss = 0.03448
2026-01-07-14-50-27	Epoch 115	Train Loss = 0.00878, Val Loss = 0.03535
2026-01-07-14-52-33	Epoch 116	Train Loss = 0.00875, Val Loss = 0.03500
2026-01-07-14-54-40	Epoch 117	Train Loss = 0.00869, Val Loss = 0.03449
2026-01-07-14-56-47	Epoch 118	Train Loss = 0.00872, Val Loss = 0.03467
2026-01-07-14-58-53	Epoch 119	Train Loss = 0.00865, Val Loss = 0.03444
2026-01-07-15-01-00	Epoch 120	Train Loss = 0.00864, Val Loss = 0.03529
2026-01-07-15-03-07	Epoch 121	Train Loss = 0.00854, Val Loss = 0.03439
2026-01-07-15-05-14	Epoch 122	Train Loss = 0.00852, Val Loss = 0.03514
2026-01-07-15-07-21	Epoch 123	Train Loss = 0.00855, Val Loss = 0.03514
2026-01-07-15-09-28	Epoch 124	Train Loss = 0.00850, Val Loss = 0.03506
2026-01-07-15-11-35	Epoch 125	Train Loss = 0.00848, Val Loss = 0.03543
2026-01-07-15-13-41	Epoch 126	Train Loss = 0.00843, Val Loss = 0.03434
2026-01-07-15-15-48	Epoch 127	Train Loss = 0.00840, Val Loss = 0.03521
2026-01-07-15-17-55	Epoch 128	Train Loss = 0.00832, Val Loss = 0.03457
2026-01-07-15-20-02	Epoch 129	Train Loss = 0.00830, Val Loss = 0.03491
2026-01-07-15-22-09	Epoch 130	Train Loss = 0.00830, Val Loss = 0.03507
2026-01-07-15-24-15	Epoch 131	Train Loss = 0.00832, Val Loss = 0.03518
2026-01-07-15-26-22	Epoch 132	Train Loss = 0.00820, Val Loss = 0.03493
2026-01-07-15-28-29	Epoch 133	Train Loss = 0.00816, Val Loss = 0.03463
2026-01-07-15-30-36	Epoch 134	Train Loss = 0.00815, Val Loss = 0.03521
2026-01-07-15-32-43	Epoch 135	Train Loss = 0.00816, Val Loss = 0.03506
2026-01-07-15-34-49	Epoch 136	Train Loss = 0.00811, Val Loss = 0.03511
2026-01-07-15-36-56	Epoch 137	Train Loss = 0.00811, Val Loss = 0.03460
2026-01-07-15-39-03	Epoch 138	Train Loss = 0.00802, Val Loss = 0.03437
2026-01-07-15-41-09	Epoch 139	Train Loss = 0.00800, Val Loss = 0.03495
2026-01-07-15-43-16	Epoch 140	Train Loss = 0.00799, Val Loss = 0.03511
2026-01-07-15-45-23	Epoch 141	Train Loss = 0.00807, Val Loss = 0.03492
2026-01-07-15-47-30	Epoch 142	Train Loss = 0.00797, Val Loss = 0.03438
2026-01-07-15-49-37	Epoch 143	Train Loss = 0.00789, Val Loss = 0.03475
2026-01-07-15-51-43	Epoch 144	Train Loss = 0.00788, Val Loss = 0.03436
2026-01-07-15-53-50	Epoch 145	Train Loss = 0.00783, Val Loss = 0.03509
2026-01-07-15-55-57	Epoch 146	Train Loss = 0.00780, Val Loss = 0.03448
2026-01-07-15-58-04	Epoch 147	Train Loss = 0.00782, Val Loss = 0.03456
2026-01-07-16-00-10	Epoch 148	Train Loss = 0.00780, Val Loss = 0.03482
Early stopping at epoch: 148
Best at epoch 48:
Train Loss = 0.01298
Train RMSE = 269.65088, MAE = 228.66306, MAPE = 14488.76758
Val Loss = 0.03276
Val RMSE = 272.81586, MAE = 231.18193, MAPE = 12110.70898
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-07-10-47-19.pt
--------- Test ---------
All Steps RMSE = 24.68875, MAE = 15.67823, MAPE = 9.07214
Step  1 RMSE = 20.23080, MAE = 13.14507, MAPE = 7.84324
Step  2 RMSE = 21.47210, MAE = 13.80040, MAPE = 8.10448
Step  3 RMSE = 22.52260, MAE = 14.47310, MAPE = 8.28517
Step  4 RMSE = 23.25208, MAE = 14.81901, MAPE = 8.68797
Step  5 RMSE = 23.90900, MAE = 15.15662, MAPE = 8.81618
Step  6 RMSE = 24.65363, MAE = 15.56789, MAPE = 9.15433
Step  7 RMSE = 25.39290, MAE = 16.17263, MAPE = 9.34624
Step  8 RMSE = 25.68625, MAE = 16.28874, MAPE = 9.27684
Step  9 RMSE = 26.26459, MAE = 16.69410, MAPE = 9.50782
Step 10 RMSE = 26.56645, MAE = 16.80692, MAPE = 9.72058
Step 11 RMSE = 27.26710, MAE = 17.47673, MAPE = 10.12878
Step 12 RMSE = 27.80333, MAE = 17.73754, MAPE = 9.99433

Inference time: 12.91 s
