{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'huber', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'progressive', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-04-22-54-04	Epoch 1	Train Loss = 0.29752, Val Loss = 0.08435
2026-01-04-22-56-20	Epoch 2	Train Loss = 0.04003, Val Loss = 0.04342
2026-01-04-22-58-37	Epoch 3	Train Loss = 0.02616, Val Loss = 0.04662
2026-01-04-23-00-54	Epoch 4	Train Loss = 0.02367, Val Loss = 0.04192
2026-01-04-23-03-11	Epoch 5	Train Loss = 0.02306, Val Loss = 0.03837
2026-01-04-23-05-28	Epoch 6	Train Loss = 0.02188, Val Loss = 0.03779
2026-01-04-23-07-45	Epoch 7	Train Loss = 0.02082, Val Loss = 0.03746
2026-01-04-23-10-02	Epoch 8	Train Loss = 0.02056, Val Loss = 0.03572
2026-01-04-23-12-19	Epoch 9	Train Loss = 0.01958, Val Loss = 0.03787
2026-01-04-23-14-36	Epoch 10	Train Loss = 0.01926, Val Loss = 0.03601
2026-01-04-23-16-53	Epoch 11	Train Loss = 0.01871, Val Loss = 0.03569
2026-01-04-23-19-09	Epoch 12	Train Loss = 0.01851, Val Loss = 0.03445
2026-01-04-23-21-26	Epoch 13	Train Loss = 0.01799, Val Loss = 0.03458
2026-01-04-23-23-43	Epoch 14	Train Loss = 0.01771, Val Loss = 0.03408
2026-01-04-23-26-00	Epoch 15	Train Loss = 0.01745, Val Loss = 0.03414
2026-01-04-23-28-17	Epoch 16	Train Loss = 0.01732, Val Loss = 0.03516
2026-01-04-23-30-34	Epoch 17	Train Loss = 0.01679, Val Loss = 0.03411
2026-01-04-23-32-50	Epoch 18	Train Loss = 0.01661, Val Loss = 0.03358
2026-01-04-23-35-07	Epoch 19	Train Loss = 0.01632, Val Loss = 0.03375
2026-01-04-23-37-24	Epoch 20	Train Loss = 0.01649, Val Loss = 0.03274
2026-01-04-23-39-41	Epoch 21	Train Loss = 0.01599, Val Loss = 0.03300
2026-01-04-23-41-58	Epoch 22	Train Loss = 0.01576, Val Loss = 0.03289
2026-01-04-23-44-14	Epoch 23	Train Loss = 0.01563, Val Loss = 0.03267
2026-01-04-23-46-31	Epoch 24	Train Loss = 0.01549, Val Loss = 0.03271
2026-01-04-23-48-48	Epoch 25	Train Loss = 0.01492, Val Loss = 0.03275
2026-01-04-23-51-05	Epoch 26	Train Loss = 0.01519, Val Loss = 0.03251
2026-01-04-23-53-22	Epoch 27	Train Loss = 0.01502, Val Loss = 0.03296
2026-01-04-23-55-38	Epoch 28	Train Loss = 0.01468, Val Loss = 0.03281
2026-01-04-23-57-55	Epoch 29	Train Loss = 0.01454, Val Loss = 0.03265
2026-01-05-00-00-12	Epoch 30	Train Loss = 0.01435, Val Loss = 0.03204
2026-01-05-00-02-29	Epoch 31	Train Loss = 0.01415, Val Loss = 0.03232
2026-01-05-00-04-46	Epoch 32	Train Loss = 0.01427, Val Loss = 0.03213
2026-01-05-00-07-03	Epoch 33	Train Loss = 0.01406, Val Loss = 0.03225
2026-01-05-00-09-20	Epoch 34	Train Loss = 0.01439, Val Loss = 0.03344
2026-01-05-00-11-37	Epoch 35	Train Loss = 0.01387, Val Loss = 0.03349
2026-01-05-00-13-54	Epoch 36	Train Loss = 0.01396, Val Loss = 0.03209
2026-01-05-00-16-11	Epoch 37	Train Loss = 0.01347, Val Loss = 0.03274
2026-01-05-00-18-27	Epoch 38	Train Loss = 0.01360, Val Loss = 0.03187
2026-01-05-00-20-44	Epoch 39	Train Loss = 0.01332, Val Loss = 0.03177
2026-01-05-00-23-01	Epoch 40	Train Loss = 0.01341, Val Loss = 0.03195
2026-01-05-00-25-18	Epoch 41	Train Loss = 0.01310, Val Loss = 0.03152
2026-01-05-00-27-35	Epoch 42	Train Loss = 0.01308, Val Loss = 0.03170
2026-01-05-00-29-52	Epoch 43	Train Loss = 0.01288, Val Loss = 0.03220
2026-01-05-00-32-09	Epoch 44	Train Loss = 0.01290, Val Loss = 0.03194
2026-01-05-00-34-26	Epoch 45	Train Loss = 0.01281, Val Loss = 0.03249
2026-01-05-00-36-43	Epoch 46	Train Loss = 0.01277, Val Loss = 0.03180
2026-01-05-00-39-00	Epoch 47	Train Loss = 0.01248, Val Loss = 0.03186
2026-01-05-00-41-16	Epoch 48	Train Loss = 0.01249, Val Loss = 0.03216
2026-01-05-00-43-33	Epoch 49	Train Loss = 0.01231, Val Loss = 0.03184
2026-01-05-00-45-50	Epoch 50	Train Loss = 0.01226, Val Loss = 0.03390
2026-01-05-00-48-07	Epoch 51	Train Loss = 0.01235, Val Loss = 0.03212
2026-01-05-00-50-24	Epoch 52	Train Loss = 0.01230, Val Loss = 0.03162
2026-01-05-00-52-41	Epoch 53	Train Loss = 0.01190, Val Loss = 0.03160
2026-01-05-00-54-58	Epoch 54	Train Loss = 0.01185, Val Loss = 0.03182
2026-01-05-00-57-14	Epoch 55	Train Loss = 0.01209, Val Loss = 0.03198
2026-01-05-00-59-31	Epoch 56	Train Loss = 0.01173, Val Loss = 0.03157
2026-01-05-01-01-48	Epoch 57	Train Loss = 0.01166, Val Loss = 0.03268
2026-01-05-01-04-05	Epoch 58	Train Loss = 0.01169, Val Loss = 0.03208
2026-01-05-01-06-22	Epoch 59	Train Loss = 0.01154, Val Loss = 0.03214
2026-01-05-01-08-39	Epoch 60	Train Loss = 0.01141, Val Loss = 0.03182
2026-01-05-01-10-56	Epoch 61	Train Loss = 0.01138, Val Loss = 0.03181
2026-01-05-01-13-12	Epoch 62	Train Loss = 0.01142, Val Loss = 0.03219
2026-01-05-01-15-29	Epoch 63	Train Loss = 0.01155, Val Loss = 0.03190
2026-01-05-01-17-46	Epoch 64	Train Loss = 0.01128, Val Loss = 0.03196
2026-01-05-01-20-03	Epoch 65	Train Loss = 0.01110, Val Loss = 0.03209
2026-01-05-01-22-20	Epoch 66	Train Loss = 0.01111, Val Loss = 0.03158
2026-01-05-01-24-37	Epoch 67	Train Loss = 0.01091, Val Loss = 0.03211
2026-01-05-01-26-53	Epoch 68	Train Loss = 0.01090, Val Loss = 0.03205
2026-01-05-01-29-10	Epoch 69	Train Loss = 0.01104, Val Loss = 0.03154
2026-01-05-01-31-27	Epoch 70	Train Loss = 0.01082, Val Loss = 0.03147
2026-01-05-01-33-44	Epoch 71	Train Loss = 0.01078, Val Loss = 0.03161
2026-01-05-01-36-01	Epoch 72	Train Loss = 0.01069, Val Loss = 0.03171
2026-01-05-01-38-17	Epoch 73	Train Loss = 0.01072, Val Loss = 0.03178
2026-01-05-01-40-34	Epoch 74	Train Loss = 0.01066, Val Loss = 0.03222
2026-01-05-01-42-51	Epoch 75	Train Loss = 0.01062, Val Loss = 0.03155
2026-01-05-01-45-08	Epoch 76	Train Loss = 0.01043, Val Loss = 0.03218
2026-01-05-01-47-25	Epoch 77	Train Loss = 0.01044, Val Loss = 0.03192
2026-01-05-01-49-41	Epoch 78	Train Loss = 0.01039, Val Loss = 0.03202
2026-01-05-01-51-58	Epoch 79	Train Loss = 0.01034, Val Loss = 0.03190
2026-01-05-01-54-15	Epoch 80	Train Loss = 0.01034, Val Loss = 0.03142
2026-01-05-01-56-32	Epoch 81	Train Loss = 0.01018, Val Loss = 0.03204
2026-01-05-01-58-48	Epoch 82	Train Loss = 0.01014, Val Loss = 0.03192
2026-01-05-02-01-05	Epoch 83	Train Loss = 0.01021, Val Loss = 0.03244
2026-01-05-02-03-21	Epoch 84	Train Loss = 0.01009, Val Loss = 0.03212
2026-01-05-02-05-38	Epoch 85	Train Loss = 0.01007, Val Loss = 0.03253
2026-01-05-02-07-54	Epoch 86	Train Loss = 0.01001, Val Loss = 0.03201
2026-01-05-02-10-11	Epoch 87	Train Loss = 0.00993, Val Loss = 0.03170
2026-01-05-02-12-28	Epoch 88	Train Loss = 0.00994, Val Loss = 0.03188
2026-01-05-02-14-44	Epoch 89	Train Loss = 0.00980, Val Loss = 0.03221
2026-01-05-02-17-01	Epoch 90	Train Loss = 0.00979, Val Loss = 0.03251
2026-01-05-02-19-17	Epoch 91	Train Loss = 0.00979, Val Loss = 0.03231
2026-01-05-02-21-34	Epoch 92	Train Loss = 0.00972, Val Loss = 0.03204
2026-01-05-02-23-50	Epoch 93	Train Loss = 0.00976, Val Loss = 0.03206
2026-01-05-02-26-07	Epoch 94	Train Loss = 0.00985, Val Loss = 0.03194
2026-01-05-02-28-23	Epoch 95	Train Loss = 0.00961, Val Loss = 0.03169
2026-01-05-02-30-40	Epoch 96	Train Loss = 0.00970, Val Loss = 0.03199
2026-01-05-02-32-57	Epoch 97	Train Loss = 0.00952, Val Loss = 0.03181
2026-01-05-02-35-13	Epoch 98	Train Loss = 0.00955, Val Loss = 0.03194
2026-01-05-02-37-30	Epoch 99	Train Loss = 0.00945, Val Loss = 0.03222
2026-01-05-02-39-47	Epoch 100	Train Loss = 0.00937, Val Loss = 0.03217
2026-01-05-02-42-03	Epoch 101	Train Loss = 0.00944, Val Loss = 0.03271
2026-01-05-02-44-20	Epoch 102	Train Loss = 0.00936, Val Loss = 0.03228
2026-01-05-02-46-37	Epoch 103	Train Loss = 0.00930, Val Loss = 0.03221
2026-01-05-02-48-53	Epoch 104	Train Loss = 0.00935, Val Loss = 0.03303
2026-01-05-02-51-10	Epoch 105	Train Loss = 0.00927, Val Loss = 0.03220
2026-01-05-02-53-26	Epoch 106	Train Loss = 0.00920, Val Loss = 0.03213
2026-01-05-02-55-43	Epoch 107	Train Loss = 0.00921, Val Loss = 0.03196
2026-01-05-02-57-59	Epoch 108	Train Loss = 0.00928, Val Loss = 0.03206
2026-01-05-03-00-16	Epoch 109	Train Loss = 0.00917, Val Loss = 0.03223
2026-01-05-03-02-32	Epoch 110	Train Loss = 0.00918, Val Loss = 0.03158
2026-01-05-03-04-49	Epoch 111	Train Loss = 0.00904, Val Loss = 0.03230
2026-01-05-03-07-06	Epoch 112	Train Loss = 0.00909, Val Loss = 0.03234
2026-01-05-03-09-22	Epoch 113	Train Loss = 0.00899, Val Loss = 0.03212
2026-01-05-03-11-39	Epoch 114	Train Loss = 0.00898, Val Loss = 0.03220
2026-01-05-03-13-55	Epoch 115	Train Loss = 0.00906, Val Loss = 0.03152
2026-01-05-03-16-12	Epoch 116	Train Loss = 0.00893, Val Loss = 0.03216
2026-01-05-03-18-29	Epoch 117	Train Loss = 0.00895, Val Loss = 0.03240
2026-01-05-03-20-45	Epoch 118	Train Loss = 0.00882, Val Loss = 0.03234
2026-01-05-03-23-02	Epoch 119	Train Loss = 0.00883, Val Loss = 0.03291
2026-01-05-03-25-19	Epoch 120	Train Loss = 0.00885, Val Loss = 0.03264
2026-01-05-03-27-35	Epoch 121	Train Loss = 0.00880, Val Loss = 0.03243
2026-01-05-03-29-52	Epoch 122	Train Loss = 0.00895, Val Loss = 0.03216
2026-01-05-03-32-09	Epoch 123	Train Loss = 0.00868, Val Loss = 0.03200
2026-01-05-03-34-25	Epoch 124	Train Loss = 0.00872, Val Loss = 0.03184
2026-01-05-03-36-42	Epoch 125	Train Loss = 0.00879, Val Loss = 0.03205
2026-01-05-03-38-58	Epoch 126	Train Loss = 0.00863, Val Loss = 0.03255
2026-01-05-03-41-15	Epoch 127	Train Loss = 0.00859, Val Loss = 0.03169
2026-01-05-03-43-31	Epoch 128	Train Loss = 0.00865, Val Loss = 0.03199
2026-01-05-03-45-48	Epoch 129	Train Loss = 0.00870, Val Loss = 0.03195
2026-01-05-03-48-04	Epoch 130	Train Loss = 0.00861, Val Loss = 0.03195
Early stopping at epoch: 130
Best at epoch 80:
Train Loss = 0.01034
Train RMSE = 271.59076, MAE = 229.87878, MAPE = 16297.82520
Val Loss = 0.03142
Val RMSE = 275.50635, MAE = 233.38390, MAPE = 11738.35742
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-04-22-51-46.pt
--------- Test ---------
All Steps RMSE = 25.96913, MAE = 16.09282, MAPE = 9.27000
Step  1 RMSE = 20.97130, MAE = 13.73285, MAPE = 8.23703
Step  2 RMSE = 22.53916, MAE = 14.52165, MAPE = 8.56323
Step  3 RMSE = 23.63574, MAE = 14.95961, MAPE = 8.60742
Step  4 RMSE = 24.55902, MAE = 15.35954, MAPE = 8.75168
Step  5 RMSE = 25.45259, MAE = 15.83339, MAPE = 9.14867
Step  6 RMSE = 26.00679, MAE = 16.11073, MAPE = 9.25558
Step  7 RMSE = 26.66342, MAE = 16.43769, MAPE = 9.30991
Step  8 RMSE = 27.20480, MAE = 16.74664, MAPE = 9.63207
Step  9 RMSE = 27.77093, MAE = 17.00499, MAPE = 9.74642
Step 10 RMSE = 28.08956, MAE = 17.20846, MAPE = 9.86415
Step 11 RMSE = 28.31610, MAE = 17.32138, MAPE = 9.80216
Step 12 RMSE = 29.08388, MAE = 17.87695, MAPE = 10.32189

Inference time: 14.18 s
