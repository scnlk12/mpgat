✓ 配置验证通过
Available GPUs: 3
Using GPUs: [0]
Using 1 GPU(s) for training
Config:
data:
  batch_size: 32
  test_ratio: 0.2
  traffic_file: data/PEMS08/PEMS08.npz
  train_ratio: 0.6
  val_ratio: 0.2
gpu:
  device_ids:
  - 0
  distributed: true
  main_device: 0
logging:
  log_dir: ./logs
  tensorboard_dir: ./runLog/mpgat
  verbose: 1
misc:
  seed: 42
  time_slot: 5
  use_amp: false
model:
  K: 8
  L: 3
  P: 12
  Q: 12
  T: 288
  d: 32
  embed_dim: 64
  input_dim: 3
  lape_dim: 64
  skip_dim: 256
saving:
  model_dir: ./saved_models
  save_best: true
training:
  clip_grad: 5
  dropout: 0.3
  gamma: 0.9
  learning_rate: 0.002
  loss_func: masked_mae
  lr_decay: false
  lr_decay_rate: 0.3
  lr_decay_step: 5,20,40,70
  max_epoch: 1500
  patience: 50
  step_size: 100
  temporal_weight_scheme: progressive
  use_cosine_annealing: true
  use_temporal_weighting: false
  warmup_epochs: 50
  weight_decay: 0.0001

{'gpu': {'device_ids': [0], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'progressive', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
Loading data...
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
Data loaded!
Using dataset: PEMS08
Graph structure file: data/PEMS08/PEMS08.csv
Number of nodes: 170
Graph loaded: 170 nodes, 274 edges
Traceback (most recent call last):
  File "/root/mpgat/test_distributed.py", line 317, in <module>
    main()
  File "/root/mpgat/test_distributed.py", line 309, in main
    main_worker(gpu_ids[0], 1, config)
  File "/root/mpgat/test_distributed.py", line 249, in main_worker
    model.load_state_dict(torch.load("saved_models/GMAN-PEMS08-2025-12-30-22-37-40.pt")['model_state_dict'])
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'model' has no attribute 'load_state_dict'
