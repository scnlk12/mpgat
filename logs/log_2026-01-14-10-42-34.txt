{'gpu': {'device_ids': [2], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'exponential', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-14-10-44-38	Epoch 1	Train Loss = 1.15880, Val Loss = 0.14862
2026-01-14-10-46-36	Epoch 2	Train Loss = 0.60631, Val Loss = 0.14639
2026-01-14-10-48-34	Epoch 3	Train Loss = 0.60091, Val Loss = 0.14527
2026-01-14-10-50-32	Epoch 4	Train Loss = 0.59858, Val Loss = 0.14549
2026-01-14-10-52-30	Epoch 5	Train Loss = 0.59509, Val Loss = 0.14475
2026-01-14-10-54-28	Epoch 6	Train Loss = 0.59313, Val Loss = 0.14446
2026-01-14-10-56-26	Epoch 7	Train Loss = 0.59083, Val Loss = 0.14403
2026-01-14-10-58-24	Epoch 8	Train Loss = 0.58909, Val Loss = 0.14410
2026-01-14-11-00-22	Epoch 9	Train Loss = 0.58788, Val Loss = 0.14382
2026-01-14-11-02-20	Epoch 10	Train Loss = 0.58676, Val Loss = 0.14362
2026-01-14-11-04-18	Epoch 11	Train Loss = 0.58546, Val Loss = 0.14344
2026-01-14-11-06-16	Epoch 12	Train Loss = 0.58436, Val Loss = 0.14299
2026-01-14-11-08-14	Epoch 13	Train Loss = 0.58275, Val Loss = 0.14278
2026-01-14-11-10-12	Epoch 14	Train Loss = 0.58136, Val Loss = 0.14341
2026-01-14-11-12-10	Epoch 15	Train Loss = 0.58156, Val Loss = 0.14314
2026-01-14-11-14-08	Epoch 16	Train Loss = 0.58045, Val Loss = 0.14249
2026-01-14-11-16-06	Epoch 17	Train Loss = 0.57965, Val Loss = 0.14211
2026-01-14-11-18-04	Epoch 18	Train Loss = 0.57878, Val Loss = 0.14184
2026-01-14-11-20-02	Epoch 19	Train Loss = 0.57877, Val Loss = 0.14302
2026-01-14-11-22-00	Epoch 20	Train Loss = 0.57769, Val Loss = 0.14145
2026-01-14-11-23-58	Epoch 21	Train Loss = 0.57689, Val Loss = 0.14136
2026-01-14-11-25-55	Epoch 22	Train Loss = 0.57461, Val Loss = 0.14005
2026-01-14-11-27-53	Epoch 23	Train Loss = 0.56023, Val Loss = 0.13532
2026-01-14-11-29-51	Epoch 24	Train Loss = 0.54078, Val Loss = 0.12859
2026-01-14-11-31-48	Epoch 25	Train Loss = 0.53462, Val Loss = 0.12864
2026-01-14-11-33-46	Epoch 26	Train Loss = 0.53158, Val Loss = 0.12639
2026-01-14-11-35-44	Epoch 27	Train Loss = 0.53123, Val Loss = 0.12656
2026-01-14-11-37-42	Epoch 28	Train Loss = 0.52841, Val Loss = 0.12531
2026-01-14-11-39-39	Epoch 29	Train Loss = 0.52576, Val Loss = 0.12828
2026-01-14-11-41-37	Epoch 30	Train Loss = 0.52590, Val Loss = 0.12465
2026-01-14-11-43-35	Epoch 31	Train Loss = 0.52425, Val Loss = 0.12455
2026-01-14-11-45-32	Epoch 32	Train Loss = 0.52414, Val Loss = 0.12457
2026-01-14-11-47-30	Epoch 33	Train Loss = 0.52203, Val Loss = 0.12421
2026-01-14-11-49-27	Epoch 34	Train Loss = 0.52183, Val Loss = 0.12368
2026-01-14-11-51-25	Epoch 35	Train Loss = 0.52067, Val Loss = 0.12407
2026-01-14-11-53-23	Epoch 36	Train Loss = 0.51890, Val Loss = 0.12349
2026-01-14-11-55-20	Epoch 37	Train Loss = 0.51851, Val Loss = 0.12300
2026-01-14-11-57-18	Epoch 38	Train Loss = 0.51732, Val Loss = 0.12260
2026-01-14-11-59-16	Epoch 39	Train Loss = 0.51763, Val Loss = 0.12430
2026-01-14-12-01-13	Epoch 40	Train Loss = 0.51856, Val Loss = 0.12206
2026-01-14-12-03-11	Epoch 41	Train Loss = 0.55339, Val Loss = 0.14022
2026-01-14-12-05-09	Epoch 42	Train Loss = 0.53529, Val Loss = 0.13445
2026-01-14-12-07-06	Epoch 43	Train Loss = 0.53047, Val Loss = 0.13363
2026-01-14-12-09-04	Epoch 44	Train Loss = 0.53036, Val Loss = 0.13194
2026-01-14-12-11-01	Epoch 45	Train Loss = 0.52686, Val Loss = 0.13098
2026-01-14-12-12-59	Epoch 46	Train Loss = 0.52610, Val Loss = 0.13087
2026-01-14-12-14-56	Epoch 47	Train Loss = 0.52477, Val Loss = 0.13355
2026-01-14-12-16-54	Epoch 48	Train Loss = 0.53261, Val Loss = 0.13308
2026-01-14-12-18-52	Epoch 49	Train Loss = 0.52573, Val Loss = 0.13135
2026-01-14-12-20-49	Epoch 50	Train Loss = 0.52360, Val Loss = 0.12969
2026-01-14-12-22-47	Epoch 51	Train Loss = 0.52244, Val Loss = 0.13003
2026-01-14-12-24-44	Epoch 52	Train Loss = 0.52121, Val Loss = 0.12863
2026-01-14-12-26-42	Epoch 53	Train Loss = 0.52009, Val Loss = 0.12905
2026-01-14-12-28-39	Epoch 54	Train Loss = 0.51935, Val Loss = 0.12832
2026-01-14-12-30-37	Epoch 55	Train Loss = 0.51984, Val Loss = 0.12743
2026-01-14-12-32-34	Epoch 56	Train Loss = 0.51745, Val Loss = 0.12727
2026-01-14-12-34-31	Epoch 57	Train Loss = 0.51633, Val Loss = 0.12743
2026-01-14-12-36-29	Epoch 58	Train Loss = 0.51554, Val Loss = 0.12648
2026-01-14-12-38-26	Epoch 59	Train Loss = 0.51450, Val Loss = 0.12621
2026-01-14-12-40-24	Epoch 60	Train Loss = 0.51430, Val Loss = 0.12668
2026-01-14-12-42-21	Epoch 61	Train Loss = 0.51340, Val Loss = 0.12702
2026-01-14-12-44-19	Epoch 62	Train Loss = 0.51402, Val Loss = 0.12514
2026-01-14-12-46-16	Epoch 63	Train Loss = 0.51274, Val Loss = 0.12595
2026-01-14-12-48-14	Epoch 64	Train Loss = 0.51196, Val Loss = 0.12479
2026-01-14-12-50-11	Epoch 65	Train Loss = 0.51076, Val Loss = 0.12581
2026-01-14-12-52-09	Epoch 66	Train Loss = 0.51036, Val Loss = 0.12499
2026-01-14-12-54-06	Epoch 67	Train Loss = 0.51176, Val Loss = 0.12486
2026-01-14-12-56-04	Epoch 68	Train Loss = 0.51103, Val Loss = 0.12479
2026-01-14-12-58-01	Epoch 69	Train Loss = 0.51013, Val Loss = 0.12460
2026-01-14-12-59-59	Epoch 70	Train Loss = 0.51034, Val Loss = 0.12585
2026-01-14-13-01-56	Epoch 71	Train Loss = 0.56897, Val Loss = 0.15555
2026-01-14-13-03-54	Epoch 72	Train Loss = 0.54628, Val Loss = 0.14847
2026-01-14-13-05-51	Epoch 73	Train Loss = 0.54205, Val Loss = 0.14371
2026-01-14-13-07-49	Epoch 74	Train Loss = 0.53686, Val Loss = 0.14135
2026-01-14-13-09-46	Epoch 75	Train Loss = 0.53315, Val Loss = 0.13968
2026-01-14-13-11-43	Epoch 76	Train Loss = 0.53360, Val Loss = 0.14250
2026-01-14-13-13-41	Epoch 77	Train Loss = 0.53413, Val Loss = 0.14169
2026-01-14-13-15-38	Epoch 78	Train Loss = 0.53333, Val Loss = 0.14031
2026-01-14-13-17-36	Epoch 79	Train Loss = 0.53349, Val Loss = 0.13872
2026-01-14-13-19-33	Epoch 80	Train Loss = 0.53545, Val Loss = 0.13937
2026-01-14-13-21-30	Epoch 81	Train Loss = 0.53222, Val Loss = 0.13756
2026-01-14-13-23-28	Epoch 82	Train Loss = 0.53062, Val Loss = 0.14080
2026-01-14-13-25-25	Epoch 83	Train Loss = 0.53152, Val Loss = 0.13926
2026-01-14-13-27-23	Epoch 84	Train Loss = 0.52872, Val Loss = 0.13853
2026-01-14-13-29-20	Epoch 85	Train Loss = 0.53761, Val Loss = 0.14126
2026-01-14-13-31-18	Epoch 86	Train Loss = 0.53842, Val Loss = 0.14394
2026-01-14-13-33-15	Epoch 87	Train Loss = 0.53716, Val Loss = 0.14139
2026-01-14-13-35-12	Epoch 88	Train Loss = 0.53556, Val Loss = 0.13882
2026-01-14-13-37-09	Epoch 89	Train Loss = 0.53173, Val Loss = 0.13969
2026-01-14-13-39-07	Epoch 90	Train Loss = 0.53344, Val Loss = 0.14253
2026-01-14-13-41-04	Epoch 91	Train Loss = 0.53583, Val Loss = 0.14599
2026-01-14-13-43-01	Epoch 92	Train Loss = 0.54538, Val Loss = 0.14290
2026-01-14-13-44-59	Epoch 93	Train Loss = 0.54057, Val Loss = 0.14443
2026-01-14-13-46-56	Epoch 94	Train Loss = 0.53389, Val Loss = 0.13834
2026-01-14-13-48-53	Epoch 95	Train Loss = 0.53220, Val Loss = 0.14078
2026-01-14-13-50-50	Epoch 96	Train Loss = 0.53818, Val Loss = 0.13726
2026-01-14-13-52-47	Epoch 97	Train Loss = 0.53318, Val Loss = 0.13763
2026-01-14-13-54-45	Epoch 98	Train Loss = 0.53564, Val Loss = 0.14127
2026-01-14-13-56-42	Epoch 99	Train Loss = 0.53984, Val Loss = 0.14263
2026-01-14-13-58-39	Epoch 100	Train Loss = 0.54450, Val Loss = 0.14998
2026-01-14-14-00-36	Epoch 101	Train Loss = 0.54361, Val Loss = 0.15292
2026-01-14-14-02-34	Epoch 102	Train Loss = 0.54261, Val Loss = 0.14900
2026-01-14-14-04-31	Epoch 103	Train Loss = 0.54437, Val Loss = 0.14401
2026-01-14-14-06-28	Epoch 104	Train Loss = 0.54362, Val Loss = 0.14970
2026-01-14-14-08-26	Epoch 105	Train Loss = 0.55198, Val Loss = 0.15867
2026-01-14-14-10-23	Epoch 106	Train Loss = 0.54978, Val Loss = 0.14405
2026-01-14-14-12-20	Epoch 107	Train Loss = 0.53987, Val Loss = 0.14147
2026-01-14-14-14-17	Epoch 108	Train Loss = 0.54074, Val Loss = 0.14551
2026-01-14-14-16-15	Epoch 109	Train Loss = 0.54200, Val Loss = 0.15535
2026-01-14-14-18-12	Epoch 110	Train Loss = 0.54586, Val Loss = 0.14743
2026-01-14-14-20-09	Epoch 111	Train Loss = 0.54063, Val Loss = 0.14611
2026-01-14-14-22-06	Epoch 112	Train Loss = 0.55404, Val Loss = 0.14987
2026-01-14-14-24-03	Epoch 113	Train Loss = 0.54436, Val Loss = 0.14245
2026-01-14-14-26-01	Epoch 114	Train Loss = 0.53971, Val Loss = 0.14597
2026-01-14-14-27-58	Epoch 115	Train Loss = 0.54641, Val Loss = 0.14986
2026-01-14-14-29-55	Epoch 116	Train Loss = 0.54796, Val Loss = 0.14384
2026-01-14-14-31-52	Epoch 117	Train Loss = 0.53940, Val Loss = 0.13998
2026-01-14-14-33-50	Epoch 118	Train Loss = 0.53588, Val Loss = 0.14096
2026-01-14-14-35-47	Epoch 119	Train Loss = 0.54150, Val Loss = 0.14685
2026-01-14-14-37-44	Epoch 120	Train Loss = 0.54075, Val Loss = 0.14252
2026-01-14-14-39-41	Epoch 121	Train Loss = 0.55510, Val Loss = 0.14726
2026-01-14-14-41-39	Epoch 122	Train Loss = 0.54432, Val Loss = 0.14355
2026-01-14-14-43-36	Epoch 123	Train Loss = 0.54100, Val Loss = 0.14227
2026-01-14-14-45-33	Epoch 124	Train Loss = 0.54305, Val Loss = 0.14244
2026-01-14-14-47-30	Epoch 125	Train Loss = 0.54355, Val Loss = 0.14732
2026-01-14-14-49-28	Epoch 126	Train Loss = 0.53719, Val Loss = 0.14184
2026-01-14-14-51-25	Epoch 127	Train Loss = 0.53622, Val Loss = 0.14030
2026-01-14-14-53-22	Epoch 128	Train Loss = 0.54104, Val Loss = 0.14674
2026-01-14-14-55-19	Epoch 129	Train Loss = 0.53712, Val Loss = 0.14288
2026-01-14-14-57-17	Epoch 130	Train Loss = 0.53629, Val Loss = 0.14444
2026-01-14-14-59-14	Epoch 131	Train Loss = 0.54808, Val Loss = 0.15515
2026-01-14-15-01-11	Epoch 132	Train Loss = 0.55114, Val Loss = 0.15172
2026-01-14-15-03-09	Epoch 133	Train Loss = 0.55219, Val Loss = 0.14458
2026-01-14-15-05-06	Epoch 134	Train Loss = 0.54876, Val Loss = 0.15616
2026-01-14-15-07-03	Epoch 135	Train Loss = 0.54776, Val Loss = 0.14891
2026-01-14-15-09-00	Epoch 136	Train Loss = 0.53982, Val Loss = 0.14434
2026-01-14-15-10-57	Epoch 137	Train Loss = 0.54013, Val Loss = 0.14487
2026-01-14-15-12-55	Epoch 138	Train Loss = 0.53555, Val Loss = 0.13937
2026-01-14-15-14-52	Epoch 139	Train Loss = 0.53363, Val Loss = 0.13958
2026-01-14-15-16-49	Epoch 140	Train Loss = 0.53074, Val Loss = 0.14109
2026-01-14-15-18-46	Epoch 141	Train Loss = 0.53512, Val Loss = 0.14038
2026-01-14-15-20-44	Epoch 142	Train Loss = 0.53230, Val Loss = 0.14025
2026-01-14-15-22-41	Epoch 143	Train Loss = 0.54152, Val Loss = 0.14069
2026-01-14-15-24-38	Epoch 144	Train Loss = 0.53359, Val Loss = 0.14060
2026-01-14-15-26-36	Epoch 145	Train Loss = 0.53276, Val Loss = 0.13748
2026-01-14-15-28-33	Epoch 146	Train Loss = 0.53127, Val Loss = 0.13875
Early stopping at epoch: 146
Best at epoch 96:
Train Loss = 0.53818
Train RMSE = 271.57208, MAE = 230.57288, MAPE = 14165.17383
Val Loss = 0.13726
Val RMSE = 274.72516, MAE = 232.89696, MAPE = 11600.72656
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-14-10-42-38.pt
--------- Test ---------
All Steps RMSE = 25.86836, MAE = 16.29131, MAPE = 9.38823
Step  1 RMSE = 20.22497, MAE = 12.91300, MAPE = 7.53064
Step  2 RMSE = 21.98740, MAE = 13.96098, MAPE = 8.04829
Step  3 RMSE = 23.22941, MAE = 14.72235, MAPE = 8.44246
Step  4 RMSE = 24.14481, MAE = 15.27855, MAPE = 8.77389
Step  5 RMSE = 24.97163, MAE = 15.75739, MAPE = 9.06891
Step  6 RMSE = 25.71568, MAE = 16.19686, MAPE = 9.29598
Step  7 RMSE = 26.37306, MAE = 16.70979, MAPE = 9.62494
Step  8 RMSE = 27.24463, MAE = 17.18698, MAPE = 9.86118
Step  9 RMSE = 27.72258, MAE = 17.51735, MAPE = 10.10615
Step 10 RMSE = 28.45672, MAE = 17.94548, MAPE = 10.31004
Step 11 RMSE = 28.85602, MAE = 18.33177, MAPE = 10.59614
Step 12 RMSE = 29.68682, MAE = 18.97526, MAPE = 11.00053

Inference time: 11.37 s
