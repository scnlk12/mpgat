{'gpu': {'device_ids': [1], 'distributed': True, 'main_device': 0}, 'data': {'traffic_file': 'data/PEMS08/PEMS08.npz', 'train_ratio': 0.6, 'val_ratio': 0.2, 'test_ratio': 0.2, 'batch_size': 32}, 'model': {'input_dim': 3, 'P': 12, 'Q': 12, 'T': 288, 'L': 3, 'K': 8, 'd': 32, 'embed_dim': 64, 'skip_dim': 256, 'lape_dim': 64}, 'training': {'max_epoch': 1500, 'patience': 50, 'learning_rate': 0.002, 'clip_grad': 5, 'loss_func': 'masked_mae', 'use_temporal_weighting': False, 'temporal_weight_scheme': 'exponential', 'use_cosine_annealing': True, 'lr_decay': False, 'lr_decay_rate': 0.3, 'lr_decay_step': '5,20,40,70', 'step_size': 100, 'gamma': 0.9, 'weight_decay': 0.0001, 'dropout': 0.3, 'warmup_epochs': 50}, 'logging': {'log_dir': './logs', 'tensorboard_dir': './runLog/mpgat', 'verbose': 1}, 'saving': {'model_dir': './saved_models', 'save_best': True}, 'misc': {'seed': 42, 'time_slot': 5, 'use_amp': False}}
train	x: (10714, 12, 170, 3), y: (10714, 12, 170, 3)
eval	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
test	x: (3571, 12, 170, 3), y: (3571, 12, 170, 3)
2026-01-11-23-57-29	Epoch 1	Train Loss = 0.17508, Val Loss = 0.17190
2026-01-11-23-59-36	Epoch 2	Train Loss = 0.13015, Val Loss = 0.14764
2026-01-12-00-01-43	Epoch 3	Train Loss = 0.12661, Val Loss = 0.14553
2026-01-12-00-03-50	Epoch 4	Train Loss = 0.12519, Val Loss = 0.14349
2026-01-12-00-05-56	Epoch 5	Train Loss = 0.12508, Val Loss = 0.14534
2026-01-12-00-08-03	Epoch 6	Train Loss = 0.12406, Val Loss = 0.14536
2026-01-12-00-10-10	Epoch 7	Train Loss = 0.12347, Val Loss = 0.14031
2026-01-12-00-12-16	Epoch 8	Train Loss = 0.11782, Val Loss = 0.13834
2026-01-12-00-14-23	Epoch 9	Train Loss = 0.11081, Val Loss = 0.13244
2026-01-12-00-16-30	Epoch 10	Train Loss = 0.10737, Val Loss = 0.12746
2026-01-12-00-18-36	Epoch 11	Train Loss = 0.10580, Val Loss = 0.12535
2026-01-12-00-20-43	Epoch 12	Train Loss = 0.10472, Val Loss = 0.12724
2026-01-12-00-22-50	Epoch 13	Train Loss = 0.10429, Val Loss = 0.12453
2026-01-12-00-24-56	Epoch 14	Train Loss = 0.10343, Val Loss = 0.12444
2026-01-12-00-27-03	Epoch 15	Train Loss = 0.10243, Val Loss = 0.12373
2026-01-12-00-29-10	Epoch 16	Train Loss = 0.10198, Val Loss = 0.12304
2026-01-12-00-31-16	Epoch 17	Train Loss = 0.10187, Val Loss = 0.12682
2026-01-12-00-33-23	Epoch 18	Train Loss = 0.10057, Val Loss = 0.12145
2026-01-12-00-35-30	Epoch 19	Train Loss = 0.10185, Val Loss = 0.12318
2026-01-12-00-37-36	Epoch 20	Train Loss = 0.10077, Val Loss = 0.12158
2026-01-12-00-39-43	Epoch 21	Train Loss = 0.10056, Val Loss = 0.12061
2026-01-12-00-41-50	Epoch 22	Train Loss = 0.09914, Val Loss = 0.11985
2026-01-12-00-43-56	Epoch 23	Train Loss = 0.09855, Val Loss = 0.12225
2026-01-12-00-46-03	Epoch 24	Train Loss = 0.09843, Val Loss = 0.12002
2026-01-12-00-48-10	Epoch 25	Train Loss = 0.09815, Val Loss = 0.11897
2026-01-12-00-50-16	Epoch 26	Train Loss = 0.09752, Val Loss = 0.11854
2026-01-12-00-52-23	Epoch 27	Train Loss = 0.09722, Val Loss = 0.11938
2026-01-12-00-54-30	Epoch 28	Train Loss = 0.09693, Val Loss = 0.11846
2026-01-12-00-56-36	Epoch 29	Train Loss = 0.09606, Val Loss = 0.11755
2026-01-12-00-58-43	Epoch 30	Train Loss = 0.09581, Val Loss = 0.11730
2026-01-12-01-00-50	Epoch 31	Train Loss = 0.09552, Val Loss = 0.11673
2026-01-12-01-02-56	Epoch 32	Train Loss = 0.09507, Val Loss = 0.11735
2026-01-12-01-05-03	Epoch 33	Train Loss = 0.09544, Val Loss = 0.11875
2026-01-12-01-07-10	Epoch 34	Train Loss = 0.09520, Val Loss = 0.11968
2026-01-12-01-09-16	Epoch 35	Train Loss = 0.09430, Val Loss = 0.11680
2026-01-12-01-11-23	Epoch 36	Train Loss = 0.09394, Val Loss = 0.11621
2026-01-12-01-13-29	Epoch 37	Train Loss = 0.09405, Val Loss = 0.11598
2026-01-12-01-15-36	Epoch 38	Train Loss = 0.09342, Val Loss = 0.11659
2026-01-12-01-17-43	Epoch 39	Train Loss = 0.09369, Val Loss = 0.11509
2026-01-12-01-19-49	Epoch 40	Train Loss = 0.09324, Val Loss = 0.11514
2026-01-12-01-21-56	Epoch 41	Train Loss = 0.14945, Val Loss = 0.12583
2026-01-12-01-24-02	Epoch 42	Train Loss = 0.10287, Val Loss = 0.12413
2026-01-12-01-26-09	Epoch 43	Train Loss = 0.10136, Val Loss = 0.12569
2026-01-12-01-28-15	Epoch 44	Train Loss = 0.10032, Val Loss = 0.12252
2026-01-12-01-30-22	Epoch 45	Train Loss = 0.10026, Val Loss = 0.12237
2026-01-12-01-32-29	Epoch 46	Train Loss = 0.09919, Val Loss = 0.12235
2026-01-12-01-34-35	Epoch 47	Train Loss = 0.09826, Val Loss = 0.12107
2026-01-12-01-36-42	Epoch 48	Train Loss = 0.09789, Val Loss = 0.12119
2026-01-12-01-38-48	Epoch 49	Train Loss = 0.09745, Val Loss = 0.12185
2026-01-12-01-40-55	Epoch 50	Train Loss = 0.09643, Val Loss = 0.12133
2026-01-12-01-43-01	Epoch 51	Train Loss = 0.09648, Val Loss = 0.11984
2026-01-12-01-45-08	Epoch 52	Train Loss = 0.09588, Val Loss = 0.12053
2026-01-12-01-47-14	Epoch 53	Train Loss = 0.09536, Val Loss = 0.11884
2026-01-12-01-49-21	Epoch 54	Train Loss = 0.09484, Val Loss = 0.11953
2026-01-12-01-51-27	Epoch 55	Train Loss = 0.09514, Val Loss = 0.12051
2026-01-12-01-53-34	Epoch 56	Train Loss = 0.09425, Val Loss = 0.11921
2026-01-12-01-55-40	Epoch 57	Train Loss = 0.09380, Val Loss = 0.12000
2026-01-12-01-57-47	Epoch 58	Train Loss = 0.09350, Val Loss = 0.11860
2026-01-12-01-59-53	Epoch 59	Train Loss = 0.09333, Val Loss = 0.11902
2026-01-12-02-02-00	Epoch 60	Train Loss = 0.09279, Val Loss = 0.11864
2026-01-12-02-04-07	Epoch 61	Train Loss = 0.09271, Val Loss = 0.11829
2026-01-12-02-06-13	Epoch 62	Train Loss = 0.09186, Val Loss = 0.11761
2026-01-12-02-08-20	Epoch 63	Train Loss = 0.09227, Val Loss = 0.11699
2026-01-12-02-10-26	Epoch 64	Train Loss = 0.09137, Val Loss = 0.11665
2026-01-12-02-12-33	Epoch 65	Train Loss = 0.09177, Val Loss = 0.11920
2026-01-12-02-14-39	Epoch 66	Train Loss = 0.09103, Val Loss = 0.11764
2026-01-12-02-16-46	Epoch 67	Train Loss = 0.09068, Val Loss = 0.11696
2026-01-12-02-18-52	Epoch 68	Train Loss = 0.09022, Val Loss = 0.11675
2026-01-12-02-20-59	Epoch 69	Train Loss = 0.09036, Val Loss = 0.11616
2026-01-12-02-23-05	Epoch 70	Train Loss = 0.08954, Val Loss = 0.11583
2026-01-12-02-25-12	Epoch 71	Train Loss = 0.15292, Val Loss = 0.13192
2026-01-12-02-27-18	Epoch 72	Train Loss = 0.10346, Val Loss = 0.12858
2026-01-12-02-29-25	Epoch 73	Train Loss = 0.10104, Val Loss = 0.12821
2026-01-12-02-31-31	Epoch 74	Train Loss = 0.09894, Val Loss = 0.12783
2026-01-12-02-33-38	Epoch 75	Train Loss = 0.09876, Val Loss = 0.12508
2026-01-12-02-35-44	Epoch 76	Train Loss = 0.09738, Val Loss = 0.12495
2026-01-12-02-37-51	Epoch 77	Train Loss = 0.09692, Val Loss = 0.12470
2026-01-12-02-39-57	Epoch 78	Train Loss = 0.09617, Val Loss = 0.12586
2026-01-12-02-42-04	Epoch 79	Train Loss = 0.09555, Val Loss = 0.12459
2026-01-12-02-44-11	Epoch 80	Train Loss = 0.09509, Val Loss = 0.12891
2026-01-12-02-46-17	Epoch 81	Train Loss = 0.09475, Val Loss = 0.12580
2026-01-12-02-48-24	Epoch 82	Train Loss = 0.09426, Val Loss = 0.12333
2026-01-12-02-50-30	Epoch 83	Train Loss = 0.09370, Val Loss = 0.12703
2026-01-12-02-52-37	Epoch 84	Train Loss = 0.09337, Val Loss = 0.12238
2026-01-12-02-54-43	Epoch 85	Train Loss = 0.09276, Val Loss = 0.12446
2026-01-12-02-56-50	Epoch 86	Train Loss = 0.09267, Val Loss = 0.12287
2026-01-12-02-58-56	Epoch 87	Train Loss = 0.09232, Val Loss = 0.12351
2026-01-12-03-01-03	Epoch 88	Train Loss = 0.09165, Val Loss = 0.12323
2026-01-12-03-03-09	Epoch 89	Train Loss = 0.09221, Val Loss = 0.12277
2026-01-12-03-05-16	Epoch 90	Train Loss = 0.09122, Val Loss = 0.12364
2026-01-12-03-07-22	Epoch 91	Train Loss = 0.09129, Val Loss = 0.12207
2026-01-12-03-09-29	Epoch 92	Train Loss = 0.09078, Val Loss = 0.12389
2026-01-12-03-11-35	Epoch 93	Train Loss = 0.09053, Val Loss = 0.12240
2026-01-12-03-13-42	Epoch 94	Train Loss = 0.08988, Val Loss = 0.12218
2026-01-12-03-15-48	Epoch 95	Train Loss = 0.08986, Val Loss = 0.12294
2026-01-12-03-17-54	Epoch 96	Train Loss = 0.09002, Val Loss = 0.12227
2026-01-12-03-20-01	Epoch 97	Train Loss = 0.08997, Val Loss = 0.12212
2026-01-12-03-22-07	Epoch 98	Train Loss = 0.08926, Val Loss = 0.12110
2026-01-12-03-24-14	Epoch 99	Train Loss = 0.08893, Val Loss = 0.12138
2026-01-12-03-26-20	Epoch 100	Train Loss = 0.08863, Val Loss = 0.12200
2026-01-12-03-28-27	Epoch 101	Train Loss = 0.08927, Val Loss = 0.12166
2026-01-12-03-30-33	Epoch 102	Train Loss = 0.08849, Val Loss = 0.12136
2026-01-12-03-32-40	Epoch 103	Train Loss = 0.08807, Val Loss = 0.12233
2026-01-12-03-34-46	Epoch 104	Train Loss = 0.08811, Val Loss = 0.12260
2026-01-12-03-36-53	Epoch 105	Train Loss = 0.08805, Val Loss = 0.12184
2026-01-12-03-38-59	Epoch 106	Train Loss = 0.08769, Val Loss = 0.12258
2026-01-12-03-41-06	Epoch 107	Train Loss = 0.08758, Val Loss = 0.12195
2026-01-12-03-43-12	Epoch 108	Train Loss = 0.08723, Val Loss = 0.12149
2026-01-12-03-45-19	Epoch 109	Train Loss = 0.08800, Val Loss = 0.12214
2026-01-12-03-47-25	Epoch 110	Train Loss = 0.08698, Val Loss = 0.12193
2026-01-12-03-49-32	Epoch 111	Train Loss = 0.08676, Val Loss = 0.12211
2026-01-12-03-51-38	Epoch 112	Train Loss = 0.08646, Val Loss = 0.12266
2026-01-12-03-53-44	Epoch 113	Train Loss = 0.08676, Val Loss = 0.12306
2026-01-12-03-55-51	Epoch 114	Train Loss = 0.08601, Val Loss = 0.12176
2026-01-12-03-57-57	Epoch 115	Train Loss = 0.08614, Val Loss = 0.12184
2026-01-12-04-00-04	Epoch 116	Train Loss = 0.08642, Val Loss = 0.12196
2026-01-12-04-02-10	Epoch 117	Train Loss = 0.08588, Val Loss = 0.12082
2026-01-12-04-04-17	Epoch 118	Train Loss = 0.08611, Val Loss = 0.12238
2026-01-12-04-06-23	Epoch 119	Train Loss = 0.08574, Val Loss = 0.12203
2026-01-12-04-08-30	Epoch 120	Train Loss = 0.08533, Val Loss = 0.12163
2026-01-12-04-10-36	Epoch 121	Train Loss = 0.08565, Val Loss = 0.12141
2026-01-12-04-12-43	Epoch 122	Train Loss = 0.08505, Val Loss = 0.12223
2026-01-12-04-14-49	Epoch 123	Train Loss = 0.08508, Val Loss = 0.12327
2026-01-12-04-16-56	Epoch 124	Train Loss = 0.08541, Val Loss = 0.12186
2026-01-12-04-19-02	Epoch 125	Train Loss = 0.08457, Val Loss = 0.12136
2026-01-12-04-21-08	Epoch 126	Train Loss = 0.08401, Val Loss = 0.12205
2026-01-12-04-23-15	Epoch 127	Train Loss = 0.08439, Val Loss = 0.12143
2026-01-12-04-25-21	Epoch 128	Train Loss = 0.08421, Val Loss = 0.12171
2026-01-12-04-27-28	Epoch 129	Train Loss = 0.08439, Val Loss = 0.12139
2026-01-12-04-29-34	Epoch 130	Train Loss = 0.08393, Val Loss = 0.12110
2026-01-12-04-31-41	Epoch 131	Train Loss = 0.08404, Val Loss = 0.12213
2026-01-12-04-33-47	Epoch 132	Train Loss = 0.08337, Val Loss = 0.12069
2026-01-12-04-35-54	Epoch 133	Train Loss = 0.08437, Val Loss = 0.12289
2026-01-12-04-38-00	Epoch 134	Train Loss = 0.08346, Val Loss = 0.12150
2026-01-12-04-40-06	Epoch 135	Train Loss = 0.08331, Val Loss = 0.12080
2026-01-12-04-42-13	Epoch 136	Train Loss = 0.08329, Val Loss = 0.12108
2026-01-12-04-44-19	Epoch 137	Train Loss = 0.08335, Val Loss = 0.12101
2026-01-12-04-46-26	Epoch 138	Train Loss = 0.08276, Val Loss = 0.12110
2026-01-12-04-48-32	Epoch 139	Train Loss = 0.08286, Val Loss = 0.12123
2026-01-12-04-50-39	Epoch 140	Train Loss = 0.08258, Val Loss = 0.12028
2026-01-12-04-52-45	Epoch 141	Train Loss = 0.08290, Val Loss = 0.12099
2026-01-12-04-54-52	Epoch 142	Train Loss = 0.08239, Val Loss = 0.12224
2026-01-12-04-56-58	Epoch 143	Train Loss = 0.08351, Val Loss = 0.12116
2026-01-12-04-59-04	Epoch 144	Train Loss = 0.08243, Val Loss = 0.12213
2026-01-12-05-01-11	Epoch 145	Train Loss = 0.08318, Val Loss = 0.12254
2026-01-12-05-03-17	Epoch 146	Train Loss = 0.08229, Val Loss = 0.12031
2026-01-12-05-05-24	Epoch 147	Train Loss = 0.08259, Val Loss = 0.12226
2026-01-12-05-07-30	Epoch 148	Train Loss = 0.08301, Val Loss = 0.12164
2026-01-12-05-09-37	Epoch 149	Train Loss = 0.08171, Val Loss = 0.12178
2026-01-12-05-11-43	Epoch 150	Train Loss = 0.08157, Val Loss = 0.12179
2026-01-12-05-13-50	Epoch 151	Train Loss = 0.08157, Val Loss = 0.12208
2026-01-12-05-15-56	Epoch 152	Train Loss = 0.08192, Val Loss = 0.12046
2026-01-12-05-18-02	Epoch 153	Train Loss = 0.08143, Val Loss = 0.12130
2026-01-12-05-20-09	Epoch 154	Train Loss = 0.08138, Val Loss = 0.12034
2026-01-12-05-22-15	Epoch 155	Train Loss = 0.08131, Val Loss = 0.12248
2026-01-12-05-24-22	Epoch 156	Train Loss = 0.08095, Val Loss = 0.12053
2026-01-12-05-26-28	Epoch 157	Train Loss = 0.08088, Val Loss = 0.12107
2026-01-12-05-28-35	Epoch 158	Train Loss = 0.08150, Val Loss = 0.12070
2026-01-12-05-30-41	Epoch 159	Train Loss = 0.08082, Val Loss = 0.12162
2026-01-12-05-32-48	Epoch 160	Train Loss = 0.08074, Val Loss = 0.12275
2026-01-12-05-34-54	Epoch 161	Train Loss = 0.08114, Val Loss = 0.12084
2026-01-12-05-37-00	Epoch 162	Train Loss = 0.08030, Val Loss = 0.12149
2026-01-12-05-39-07	Epoch 163	Train Loss = 0.08053, Val Loss = 0.12148
2026-01-12-05-41-13	Epoch 164	Train Loss = 0.08042, Val Loss = 0.12297
2026-01-12-05-43-20	Epoch 165	Train Loss = 0.08153, Val Loss = 0.12054
2026-01-12-05-45-26	Epoch 166	Train Loss = 0.08031, Val Loss = 0.12161
2026-01-12-05-47-33	Epoch 167	Train Loss = 0.07997, Val Loss = 0.12131
2026-01-12-05-49-39	Epoch 168	Train Loss = 0.08028, Val Loss = 0.12117
2026-01-12-05-51-45	Epoch 169	Train Loss = 0.07980, Val Loss = 0.12114
2026-01-12-05-53-52	Epoch 170	Train Loss = 0.07975, Val Loss = 0.12337
2026-01-12-05-55-58	Epoch 171	Train Loss = 0.08133, Val Loss = 0.12090
2026-01-12-05-58-05	Epoch 172	Train Loss = 0.08004, Val Loss = 0.12039
2026-01-12-06-00-11	Epoch 173	Train Loss = 0.07984, Val Loss = 0.12158
2026-01-12-06-02-18	Epoch 174	Train Loss = 0.07942, Val Loss = 0.12143
2026-01-12-06-04-24	Epoch 175	Train Loss = 0.07954, Val Loss = 0.12146
2026-01-12-06-06-30	Epoch 176	Train Loss = 0.07915, Val Loss = 0.12179
2026-01-12-06-08-37	Epoch 177	Train Loss = 0.07990, Val Loss = 0.12091
2026-01-12-06-10-43	Epoch 178	Train Loss = 0.07907, Val Loss = 0.12182
2026-01-12-06-12-49	Epoch 179	Train Loss = 0.07927, Val Loss = 0.12264
2026-01-12-06-14-56	Epoch 180	Train Loss = 0.07931, Val Loss = 0.12222
2026-01-12-06-17-02	Epoch 181	Train Loss = 0.07905, Val Loss = 0.12155
2026-01-12-06-19-08	Epoch 182	Train Loss = 0.07867, Val Loss = 0.12123
2026-01-12-06-21-15	Epoch 183	Train Loss = 0.07903, Val Loss = 0.12127
2026-01-12-06-23-21	Epoch 184	Train Loss = 0.07876, Val Loss = 0.12116
2026-01-12-06-25-27	Epoch 185	Train Loss = 0.07860, Val Loss = 0.12194
2026-01-12-06-27-33	Epoch 186	Train Loss = 0.07866, Val Loss = 0.12072
2026-01-12-06-29-40	Epoch 187	Train Loss = 0.07888, Val Loss = 0.12115
2026-01-12-06-31-46	Epoch 188	Train Loss = 0.07847, Val Loss = 0.12179
2026-01-12-06-33-52	Epoch 189	Train Loss = 0.07921, Val Loss = 0.12052
2026-01-12-06-35-59	Epoch 190	Train Loss = 0.07838, Val Loss = 0.12098
Early stopping at epoch: 190
Best at epoch 140:
Train Loss = 0.08258
Train RMSE = 271.92148, MAE = 230.26685, MAPE = 16174.15137
Val Loss = 0.12028
Val RMSE = 275.88461, MAE = 233.76108, MAPE = 12507.31934
Saved Model: ./saved_models/GMAN-PEMS08-2026-01-11-23-55-22.pt
--------- Test ---------
All Steps RMSE = 24.96077, MAE = 14.42844, MAPE = 8.37312
Step  1 RMSE = 19.25102, MAE = 11.63466, MAPE = 6.84337
Step  2 RMSE = 21.36814, MAE = 12.74404, MAPE = 7.43585
Step  3 RMSE = 22.75838, MAE = 13.38145, MAPE = 7.77819
Step  4 RMSE = 23.73876, MAE = 13.87771, MAPE = 8.07069
Step  5 RMSE = 24.50122, MAE = 14.19611, MAPE = 8.22030
Step  6 RMSE = 25.17684, MAE = 14.58552, MAPE = 8.45622
Step  7 RMSE = 25.85240, MAE = 14.89717, MAPE = 8.59255
Step  8 RMSE = 26.31107, MAE = 15.18620, MAPE = 8.77643
Step  9 RMSE = 26.78345, MAE = 15.33099, MAPE = 8.87398
Step 10 RMSE = 27.19658, MAE = 15.58486, MAPE = 9.04034
Step 11 RMSE = 27.32454, MAE = 15.73346, MAPE = 9.06261
Step 12 RMSE = 27.73750, MAE = 15.98911, MAPE = 9.32710

Inference time: 12.81 s
